<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Part 5 Article figures | Chronic neck pain - Data Analysis</title>
  <meta name="description" content="Part 5 Article figures | Chronic neck pain - Data Analysis" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Part 5 Article figures | Chronic neck pain - Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Part 5 Article figures | Chronic neck pain - Data Analysis" />
  
  
  

<meta name="author" content="Marc A.T. Teunis &amp; Martine Verwoerd" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="development-and-internal-validation-of-a-multivariable-prognostic-model-for-chronification-of-non-specific-neck-pain-in-physiotherapy.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.10/DiagrammeR.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.31/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">painr-documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="exploratory-data-analysis---raw-data.html"><a href="exploratory-data-analysis---raw-data.html"><i class="fa fa-check"></i><b>1</b> Exploratory Data Analysis - Raw Data</a></li>
<li class="chapter" data-level="2" data-path="imputation-of-missing-values.html"><a href="imputation-of-missing-values.html"><i class="fa fa-check"></i><b>2</b> Imputation of missing values</a></li>
<li class="chapter" data-level="3" data-path="statistical-exploration.html"><a href="statistical-exploration.html"><i class="fa fa-check"></i><b>3</b> Statistical exploration</a></li>
<li class="chapter" data-level="4" data-path="development-and-internal-validation-of-a-multivariable-prognostic-model-for-chronification-of-non-specific-neck-pain-in-physiotherapy.html"><a href="development-and-internal-validation-of-a-multivariable-prognostic-model-for-chronification-of-non-specific-neck-pain-in-physiotherapy.html"><i class="fa fa-check"></i><b>4</b> Development and internal validation of a multivariable prognostic model for chronification of non-specific neck pain in physiotherapy</a></li>
<li class="chapter" data-level="5" data-path="article-figures.html"><a href="article-figures.html"><i class="fa fa-check"></i><b>5</b> Article figures</a></li>
<li class="divider"></li>
<li><a href="https://github.com/uashogeschoolutrecht/painr" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Chronic neck pain - Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="article-figures" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Part 5</span> Article figures<a href="article-figures.html#article-figures" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="packages-4" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Packages<a href="article-figures.html#packages-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we need to load all the required packages.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="article-figures.html#cb300-1" tabindex="-1"></a><span class="fu">library</span>(rms)</span></code></pre></div>
<pre><code>## Loading required package: Hmisc</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<pre><code>## Warning in .recacheSubclasses(def@className, def, env): undefined subclass
## &quot;ndiMatrix&quot; of class &quot;replValueSp&quot;; definition not updated</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="article-figures.html#cb305-1" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb305-2"><a href="article-figures.html#cb305-2" tabindex="-1"></a><span class="fu">library</span> (dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Hmisc&#39;:
## 
##     src, summarize</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="article-figures.html#cb310-1" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb310-2"><a href="article-figures.html#cb310-2" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## The following objects are masked from &#39;package:rms&#39;:
## 
##     Predict, vif</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="article-figures.html#cb315-1" tabindex="-1"></a><span class="fu">library</span>(fpc)</span>
<span id="cb315-2"><a href="article-figures.html#cb315-2" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code></pre></div>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## 
## Attaching package: &#39;lmtest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rms&#39;:
## 
##     lrtest</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="article-figures.html#cb321-1" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code></pre></div>
<pre><code>## Type &#39;citation(&quot;pROC&quot;)&#39; for a citation.</code></pre>
<pre><code>## 
## Attaching package: &#39;pROC&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     cov, smooth, var</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="article-figures.html#cb325-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ forcats   1.0.0     ✔ readr     2.1.5
## ✔ ggplot2   3.4.4     ✔ stringr   1.5.1
## ✔ lubridate 1.9.3     ✔ tibble    3.2.1
## ✔ purrr     1.0.2     ✔ tidyr     1.3.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter()    masks stats::filter()
## ✖ dplyr::lag()       masks stats::lag()
## ✖ car::recode()      masks dplyr::recode()
## ✖ purrr::some()      masks car::some()
## ✖ dplyr::src()       masks Hmisc::src()
## ✖ dplyr::summarize() masks Hmisc::summarize()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="article-figures.html#cb328-1" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb328-2"><a href="article-figures.html#cb328-2" tabindex="-1"></a><span class="fu">library</span>(corrr)</span>
<span id="cb328-3"><a href="article-figures.html#cb328-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb328-4"><a href="article-figures.html#cb328-4" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb328-5"><a href="article-figures.html#cb328-5" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb328-6"><a href="article-figures.html#cb328-6" tabindex="-1"></a><span class="fu">library</span>(base)</span>
<span id="cb328-7"><a href="article-figures.html#cb328-7" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb328-8"><a href="article-figures.html#cb328-8" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb328-9"><a href="article-figures.html#cb328-9" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MASS&#39;
## 
## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="article-figures.html#cb330-1" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb330-2"><a href="article-figures.html#cb330-2" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span></code></pre></div>
<pre><code>## ResourceSelection 0.3-6   2023-06-27</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="article-figures.html#cb332-1" tabindex="-1"></a><span class="fu">library</span>(xfun)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;xfun&#39;
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     attr, isFALSE</code></pre>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="article-figures.html#cb334-1" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb334-2"><a href="article-figures.html#cb334-2" tabindex="-1"></a><span class="fu">library</span>(skimr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;skimr&#39;
## 
## The following object is masked from &#39;package:corrr&#39;:
## 
##     focus</code></pre>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="article-figures.html#cb336-1" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code></pre></div>
</div>
<div id="data-load-1" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Data load<a href="article-figures.html#data-load-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here we load the build-in dataset</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="article-figures.html#cb337-1" tabindex="-1"></a>imputed_with_attitude_and_chronic <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(</span>
<span id="cb337-2"><a href="article-figures.html#cb337-2" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb337-3"><a href="article-figures.html#cb337-3" tabindex="-1"></a>    <span class="st">&quot;data&quot;</span>,</span>
<span id="cb337-4"><a href="article-figures.html#cb337-4" tabindex="-1"></a>    <span class="st">&quot;imputed_with_attitude_and_chronic.rds&quot;</span></span>
<span id="cb337-5"><a href="article-figures.html#cb337-5" tabindex="-1"></a>  )</span>
<span id="cb337-6"><a href="article-figures.html#cb337-6" tabindex="-1"></a>)</span></code></pre></div>
<div id="load-labels-for-figures" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Load labels for figures<a href="article-figures.html#load-labels-for-figures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="clean-data-and-rename-variables" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Clean data and rename variables<a href="article-figures.html#clean-data-and-rename-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="article-figures.html#cb338-1" tabindex="-1"></a>imputed_with_attitude_and_chronic <span class="ot">&lt;-</span> imputed_with_attitude_and_chronic <span class="sc">|&gt;</span></span>
<span id="cb338-2"><a href="article-figures.html#cb338-2" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">pidbr =</span> wide_spread_pain)</span>
<span id="cb338-3"><a href="article-figures.html#cb338-3" tabindex="-1"></a></span>
<span id="cb338-4"><a href="article-figures.html#cb338-4" tabindex="-1"></a><span class="do">## pidbr = pain in different body regions</span></span></code></pre></div>
</div>
<div id="exploratory-data-analysis-2" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Exploratory Data Analysis<a href="article-figures.html#exploratory-data-analysis-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="article-figures.html#cb339-1" tabindex="-1"></a><span class="fu">summary</span>(imputed_with_attitude_and_chronic)</span></code></pre></div>
<pre><code>##  sex          age          education   education_level pain_intensity  
##  1:206   Min.   :18.00   7      :208   0:321           Min.   : 1.000  
##  2:397   1st Qu.:31.00   6      :204   1:282           1st Qu.: 5.000  
##          Median :44.00   8      : 74                   Median : 6.000  
##          Mean   :44.51   2      : 42                   Mean   : 5.929  
##          3rd Qu.:56.00   4      : 30                   3rd Qu.: 7.000  
##          Max.   :85.00   3      : 20                   Max.   :10.000  
##                          (Other): 25                                   
##     duration      recurrence pidbr   headache   disability     work   
##  Min.   : 1.000   1:198      1:211   1:249    Min.   : 0.000   1:508  
##  1st Qu.: 2.000   2:405      2:392   2:284    1st Qu.: 1.000   2: 95  
##  Median : 4.000                      3: 70    Median : 2.300          
##  Mean   : 4.522                               Mean   : 2.726          
##  3rd Qu.: 6.000                               3rd Qu.: 4.100          
##  Max.   :11.000                               Max.   :11.000          
##                                                                       
##  work_happiness work_satisfaction posture_work physical_activity smoking
##  1:392          1:417             1:388        0:220             1:531  
##  2:116          2: 91             2:120        1:383             2: 72  
##  3: 95          3: 95             3: 95                                 
##                                                                         
##                                                                         
##                                                                         
##                                                                         
##  alcohol      bmi        sleep_quality catastrophizing  duration_beliefs
##  1:129   Min.   :10.73   0:130         Min.   : 0.000   Min.   : 0.000  
##  2:474   1st Qu.:22.51   1:473         1st Qu.: 1.000   1st Qu.: 2.000  
##          Median :24.66                 Median : 3.000   Median : 3.000  
##          Mean   :25.35                 Mean   : 4.587   Mean   : 4.121  
##          3rd Qu.:27.66                 3rd Qu.: 7.000   3rd Qu.: 6.000  
##          Max.   :51.06                 Max.   :24.000   Max.   :10.000  
##                                                                         
##     concerns      treatment_beliefs   depression     kinesiophobia  
##  Min.   : 0.000   Min.   : 0.000    Min.   : 0.000   Min.   : 0.00  
##  1st Qu.: 2.000   1st Qu.: 7.000    1st Qu.: 0.000   1st Qu.:12.00  
##  Median : 4.000   Median : 8.000    Median : 1.000   Median :15.00  
##  Mean   : 3.954   Mean   : 7.813    Mean   : 2.471   Mean   :16.55  
##  3rd Qu.: 6.000   3rd Qu.: 9.000    3rd Qu.: 4.000   3rd Qu.:20.00  
##  Max.   :10.000   Max.   :10.000    Max.   :20.000   Max.   :40.00  
##                                                                     
##     distress      coping  identity_beliefs hypervigilance self_efficacy  
##  Min.   : 0.000   0:122   Min.   : 0.000   Min.   : 0     Min.   : 0.00  
##  1st Qu.: 1.000   1:481   1st Qu.: 5.000   1st Qu.:23     1st Qu.:10.00  
##  Median : 3.000           Median : 6.000   Median :31     Median :11.00  
##  Mean   : 4.386           Mean   : 6.111   Mean   :31     Mean   :10.31  
##  3rd Qu.: 7.000           3rd Qu.: 8.000   3rd Qu.:38     3rd Qu.:12.00  
##  Max.   :21.000           Max.   :10.000   Max.   :76     Max.   :12.00  
##                                                                          
##     relation      painint_6weeks   painint_3months painint_6months 
##  Min.   : 0.000   Min.   : 0.000   Min.   :0.000   Min.   : 0.000  
##  1st Qu.: 8.000   1st Qu.: 0.000   1st Qu.:0.000   1st Qu.: 0.000  
##  Median : 9.000   Median : 2.000   Median :0.000   Median : 0.000  
##  Mean   : 8.799   Mean   : 2.541   Mean   :2.048   Mean   : 1.247  
##  3rd Qu.:10.000   3rd Qu.: 5.000   3rd Qu.:4.000   3rd Qu.: 1.000  
##  Max.   :10.000   Max.   :10.000   Max.   :9.000   Max.   :10.000  
##                                                                    
##     attitude      patient_code   painint_6weeks_high painint_3months_high
##  Min.   :1.000   Min.   :100.0   Mode :logical       Mode :logical       
##  1st Qu.:2.000   1st Qu.:330.5   FALSE:331           FALSE:391           
##  Median :2.000   Median :594.0   TRUE :272           TRUE :212           
##  Mean   :1.758   Mean   :570.2                                           
##  3rd Qu.:2.000   3rd Qu.:811.5                                           
##  Max.   :2.000   Max.   :999.0                                           
##  NA&#39;s   :49                                                              
##  painint_6months_high  painint_high   painint_total_score is_painint_chronic
##  Mode :logical        Min.   :0.000   Min.   : 0.000      Mode :logical     
##  FALSE:476            1st Qu.:0.000   1st Qu.: 0.000      FALSE:541         
##  TRUE :127            Median :1.000   Median : 5.000      TRUE :62          
##                       Mean   :1.013   Mean   : 5.836                        
##                       3rd Qu.:2.000   3rd Qu.: 9.000                        
##                       Max.   :3.000   Max.   :28.000                        
## </code></pre>
</div>
<div id="variabel-analysis" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Variabel analysis<a href="article-figures.html#variabel-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Identifying the independent predictive capacity of the candidate prognostic variables at baseline and the existence or non-existence of chronic pain by univariate logistic regression analysis. Univariate logistic regression for continous variables Univariate analyses, model per variable with 95 confidence interval and OR. Fitting the univariate logistic regression model. Retrieving the coefficient and standard error for “Variable”. Calculating the 95% confidence interval for “Variable”</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="article-figures.html#cb341-1" tabindex="-1"></a><span class="co"># List of continuous variables</span></span>
<span id="cb341-2"><a href="article-figures.html#cb341-2" tabindex="-1"></a>continuous_variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;depression&quot;</span>, <span class="st">&quot;concerns&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;pain_intensity&quot;</span>, <span class="st">&quot;duration&quot;</span>, <span class="st">&quot;disability&quot;</span>, <span class="st">&quot;bmi&quot;</span>, <span class="st">&quot;catastrophizing&quot;</span>, <span class="st">&quot;duration_beliefs&quot;</span>, <span class="st">&quot;treatment_beliefs&quot;</span>, <span class="st">&quot;kinesiophobia&quot;</span>, <span class="st">&quot;distress&quot;</span>, <span class="st">&quot;identity_beliefs&quot;</span>, <span class="st">&quot;hypervigilance&quot;</span>, <span class="st">&quot;relation&quot;</span>, <span class="st">&quot;self_efficacy&quot;</span>)</span>
<span id="cb341-3"><a href="article-figures.html#cb341-3" tabindex="-1"></a></span>
<span id="cb341-4"><a href="article-figures.html#cb341-4" tabindex="-1"></a><span class="co"># Function univariate analyses of the continuous variables</span></span>
<span id="cb341-5"><a href="article-figures.html#cb341-5" tabindex="-1"></a><span class="do">## Roxygen comments for man page</span></span>
<span id="cb341-6"><a href="article-figures.html#cb341-6" tabindex="-1"></a></span>
<span id="cb341-7"><a href="article-figures.html#cb341-7" tabindex="-1"></a><span class="co">#&#39; @title Run an univariate model for all continuous variables in the data</span></span>
<span id="cb341-8"><a href="article-figures.html#cb341-8" tabindex="-1"></a><span class="co">#&#39; @param variable Name of variable as a character string</span></span>
<span id="cb341-9"><a href="article-figures.html#cb341-9" tabindex="-1"></a><span class="co">#&#39; @param data Dataset &#39;imputed_with_attitude_and_chronic&#39;</span></span>
<span id="cb341-10"><a href="article-figures.html#cb341-10" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb341-11"><a href="article-figures.html#cb341-11" tabindex="-1"></a></span>
<span id="cb341-12"><a href="article-figures.html#cb341-12" tabindex="-1"></a>univariate_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(variable, </span>
<span id="cb341-13"><a href="article-figures.html#cb341-13" tabindex="-1"></a>                                           data, </span>
<span id="cb341-14"><a href="article-figures.html#cb341-14" tabindex="-1"></a>                                           <span class="at">z_score =</span> <span class="fl">1.96</span>, </span>
<span id="cb341-15"><a href="article-figures.html#cb341-15" tabindex="-1"></a>                                           <span class="at">conf_int =</span> <span class="dv">95</span>) {</span>
<span id="cb341-16"><a href="article-figures.html#cb341-16" tabindex="-1"></a>  </span>
<span id="cb341-17"><a href="article-figures.html#cb341-17" tabindex="-1"></a>  formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">&quot;is_painint_chronic ~&quot;</span>, variable))</span>
<span id="cb341-18"><a href="article-figures.html#cb341-18" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">glm</span>(formula, <span class="at">data =</span> data, <span class="at">family =</span> binomial)</span>
<span id="cb341-19"><a href="article-figures.html#cb341-19" tabindex="-1"></a> </span>
<span id="cb341-20"><a href="article-figures.html#cb341-20" tabindex="-1"></a>  conf_int_upper_limit <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;conf_int_&quot;</span>, conf_int)</span>
<span id="cb341-21"><a href="article-figures.html#cb341-21" tabindex="-1"></a>  conf_int_lower_limit <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;conf_int_&quot;</span>, (<span class="dv">100</span><span class="sc">-</span>conf_int))</span>
<span id="cb341-22"><a href="article-figures.html#cb341-22" tabindex="-1"></a>  </span>
<span id="cb341-23"><a href="article-figures.html#cb341-23" tabindex="-1"></a>  <span class="co"># get model meterics with broom</span></span>
<span id="cb341-24"><a href="article-figures.html#cb341-24" tabindex="-1"></a>  model <span class="sc">|&gt;</span> </span>
<span id="cb341-25"><a href="article-figures.html#cb341-25" tabindex="-1"></a>    broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb341-26"><a href="article-figures.html#cb341-26" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb341-27"><a href="article-figures.html#cb341-27" tabindex="-1"></a>      <span class="at">conf_int_lower =</span> <span class="fu">exp</span>(estimate <span class="sc">-</span> z_score <span class="sc">*</span> std.error),</span>
<span id="cb341-28"><a href="article-figures.html#cb341-28" tabindex="-1"></a>      <span class="at">OR =</span> <span class="fu">exp</span>(estimate),</span>
<span id="cb341-29"><a href="article-figures.html#cb341-29" tabindex="-1"></a>      <span class="at">conf_int_upper =</span> <span class="fu">exp</span>(</span>
<span id="cb341-30"><a href="article-figures.html#cb341-30" tabindex="-1"></a>        estimate <span class="sc">+</span> z_score <span class="sc">*</span> std.error)) <span class="ot">-&gt;</span> df</span>
<span id="cb341-31"><a href="article-figures.html#cb341-31" tabindex="-1"></a>  </span>
<span id="cb341-32"><a href="article-figures.html#cb341-32" tabindex="-1"></a>  <span class="fu">names</span>(df)[<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(conf_int_lower_limit, conf_int_upper_limit)</span>
<span id="cb341-33"><a href="article-figures.html#cb341-33" tabindex="-1"></a>  df</span>
<span id="cb341-34"><a href="article-figures.html#cb341-34" tabindex="-1"></a>  <span class="co"># remove Intercept term</span></span>
<span id="cb341-35"><a href="article-figures.html#cb341-35" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb341-36"><a href="article-figures.html#cb341-36" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb341-37"><a href="article-figures.html#cb341-37" tabindex="-1"></a>}</span>
<span id="cb341-38"><a href="article-figures.html#cb341-38" tabindex="-1"></a></span>
<span id="cb341-39"><a href="article-figures.html#cb341-39" tabindex="-1"></a><span class="do">## test 1</span></span>
<span id="cb341-40"><a href="article-figures.html#cb341-40" tabindex="-1"></a><span class="fu">univariate_analysis</span>(</span>
<span id="cb341-41"><a href="article-figures.html#cb341-41" tabindex="-1"></a>  <span class="at">data =</span> imputed_with_attitude_and_chronic,</span>
<span id="cb341-42"><a href="article-figures.html#cb341-42" tabindex="-1"></a>  <span class="at">variable =</span> continuous_variables[<span class="dv">1</span>],</span>
<span id="cb341-43"><a href="article-figures.html#cb341-43" tabindex="-1"></a>  <span class="at">z_score =</span> <span class="fl">1.96</span>,</span>
<span id="cb341-44"><a href="article-figures.html#cb341-44" tabindex="-1"></a>  <span class="at">conf_int =</span> <span class="dv">95</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 8
##   term       estimate std.error statistic  p.value conf_int_5    OR conf_int_95
##   &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
## 1 depression    0.113    0.0325      3.49 0.000490       1.05  1.12        1.19</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="article-figures.html#cb343-1" tabindex="-1"></a><span class="do">## test 2 - different conf int</span></span>
<span id="cb343-2"><a href="article-figures.html#cb343-2" tabindex="-1"></a><span class="fu">univariate_analysis</span>(</span>
<span id="cb343-3"><a href="article-figures.html#cb343-3" tabindex="-1"></a>  <span class="at">data =</span> imputed_with_attitude_and_chronic,</span>
<span id="cb343-4"><a href="article-figures.html#cb343-4" tabindex="-1"></a>  <span class="at">variable =</span> continuous_variables[<span class="dv">1</span>],</span>
<span id="cb343-5"><a href="article-figures.html#cb343-5" tabindex="-1"></a>  <span class="at">z_score =</span> <span class="fl">2.24</span>,</span>
<span id="cb343-6"><a href="article-figures.html#cb343-6" tabindex="-1"></a>  <span class="at">conf_int =</span> <span class="fl">97.5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 8
##   term     estimate std.error statistic p.value conf_int_2.5    OR conf_int_97.5
##   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
## 1 depress…    0.113    0.0325      3.49 4.90e-4         1.04  1.12          1.20</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="article-figures.html#cb345-1" tabindex="-1"></a><span class="do">## Univariate analyses for all continuous variables</span></span>
<span id="cb345-2"><a href="article-figures.html#cb345-2" tabindex="-1"></a><span class="do">## Iterate over all variables, leave conf int to default = 95%</span></span>
<span id="cb345-3"><a href="article-figures.html#cb345-3" tabindex="-1"></a>df_univariate_continuous <span class="ot">&lt;-</span> <span class="fu">map_df</span>(</span>
<span id="cb345-4"><a href="article-figures.html#cb345-4" tabindex="-1"></a>  <span class="at">.x =</span> continuous_variables,</span>
<span id="cb345-5"><a href="article-figures.html#cb345-5" tabindex="-1"></a>  <span class="at">.f =</span> univariate_analysis,</span>
<span id="cb345-6"><a href="article-figures.html#cb345-6" tabindex="-1"></a>  <span class="at">data =</span> imputed_with_attitude_and_chronic</span>
<span id="cb345-7"><a href="article-figures.html#cb345-7" tabindex="-1"></a>  )</span>
<span id="cb345-8"><a href="article-figures.html#cb345-8" tabindex="-1"></a></span>
<span id="cb345-9"><a href="article-figures.html#cb345-9" tabindex="-1"></a>df_univariate_continuous</span></code></pre></div>
<pre><code>## # A tibble: 16 × 8
##    term        estimate std.error statistic p.value conf_int_5    OR conf_int_95
##    &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
##  1 depression    0.113    0.0325      3.49  4.90e-4      1.05  1.12        1.19 
##  2 concerns      0.210    0.0535      3.92  8.99e-5      1.11  1.23        1.37 
##  3 age           0.0135   0.00847     1.59  1.11e-1      0.997 1.01        1.03 
##  4 pain_inten…   0.308    0.0849      3.63  2.87e-4      1.15  1.36        1.61 
##  5 duration      0.107    0.0431      2.48  1.30e-2      1.02  1.11        1.21 
##  6 disability    0.160    0.0606      2.64  8.27e-3      1.04  1.17        1.32 
##  7 bmi           0.0113   0.0298      0.380 7.04e-1      0.954 1.01        1.07 
##  8 catastroph…   0.0543   0.0267      2.03  4.21e-2      1.00  1.06        1.11 
##  9 duration_b…   0.288    0.0511      5.63  1.77e-8      1.21  1.33        1.47 
## 10 treatment_…  -0.172    0.0635     -2.71  6.81e-3      0.743 0.842       0.954
## 11 kinesiopho…   0.0382   0.0241      1.59  1.12e-1      0.991 1.04        1.09 
## 12 distress      0.116    0.0293      3.95  7.86e-5      1.06  1.12        1.19 
## 13 identity_b…  -0.0902   0.0550     -1.64  1.01e-1      0.820 0.914       1.02 
## 14 hypervigil…   0.0143   0.0117      1.23  2.20e-1      0.991 1.01        1.04 
## 15 relation     -0.135    0.0814     -1.66  9.71e-2      0.745 0.874       1.02 
## 16 self_effic…  -0.0803   0.0511     -1.57  1.16e-1      0.835 0.923       1.02</code></pre>
</div>
<div id="graph-of-model-metrics" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Graph of model metrics<a href="article-figures.html#graph-of-model-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s make a plot of the model results</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="article-figures.html#cb347-1" tabindex="-1"></a>signi_continuous_pos <span class="ot">&lt;-</span> df_univariate_continuous <span class="sc">|&gt;</span></span>
<span id="cb347-2"><a href="article-figures.html#cb347-2" tabindex="-1"></a>  <span class="fu">filter</span>(conf_int_5 <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb347-3"><a href="article-figures.html#cb347-3" tabindex="-1"></a></span>
<span id="cb347-4"><a href="article-figures.html#cb347-4" tabindex="-1"></a>signi_continuous_neg <span class="ot">&lt;-</span> df_univariate_continuous <span class="sc">|&gt;</span></span>
<span id="cb347-5"><a href="article-figures.html#cb347-5" tabindex="-1"></a>  <span class="fu">filter</span>(conf_int_95 <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb347-6"><a href="article-figures.html#cb347-6" tabindex="-1"></a></span>
<span id="cb347-7"><a href="article-figures.html#cb347-7" tabindex="-1"></a>df_univariate_continuous <span class="sc">|&gt;</span></span>
<span id="cb347-8"><a href="article-figures.html#cb347-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb347-9"><a href="article-figures.html#cb347-9" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb347-10"><a href="article-figures.html#cb347-10" tabindex="-1"></a>        <span class="at">y =</span> OR)</span>
<span id="cb347-11"><a href="article-figures.html#cb347-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb347-12"><a href="article-figures.html#cb347-12" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb347-13"><a href="article-figures.html#cb347-13" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(</span>
<span id="cb347-14"><a href="article-figures.html#cb347-14" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb347-15"><a href="article-figures.html#cb347-15" tabindex="-1"></a>      <span class="at">ymin =</span> conf_int_5, </span>
<span id="cb347-16"><a href="article-figures.html#cb347-16" tabindex="-1"></a>      <span class="at">ymax =</span> conf_int_95</span>
<span id="cb347-17"><a href="article-figures.html#cb347-17" tabindex="-1"></a>      )</span>
<span id="cb347-18"><a href="article-figures.html#cb347-18" tabindex="-1"></a>    )  <span class="sc">+</span></span>
<span id="cb347-19"><a href="article-figures.html#cb347-19" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> signi_continuous_pos, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb347-20"><a href="article-figures.html#cb347-20" tabindex="-1"></a>                <span class="at">y =</span> OR), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb347-21"><a href="article-figures.html#cb347-21" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb347-22"><a href="article-figures.html#cb347-22" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> signi_continuous_neg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb347-23"><a href="article-figures.html#cb347-23" tabindex="-1"></a>                <span class="at">y =</span> OR), <span class="at">colour =</span> <span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb347-24"><a href="article-figures.html#cb347-24" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb347-25"><a href="article-figures.html#cb347-25" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variable&quot;</span>) <span class="sc">+</span></span>
<span id="cb347-26"><a href="article-figures.html#cb347-26" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;OR&quot;</span>) <span class="sc">+</span></span>
<span id="cb347-27"><a href="article-figures.html#cb347-27" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">colour  =</span> <span class="st">&#39;darkred&#39;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb347-28"><a href="article-figures.html#cb347-28" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb347-29"><a href="article-figures.html#cb347-29" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Univariate - continuous&quot;</span>) <span class="sc">+</span></span>
<span id="cb347-30"><a href="article-figures.html#cb347-30" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="ot">-&gt;</span> plot1_univariate_continuous</span>
<span id="cb347-31"><a href="article-figures.html#cb347-31" tabindex="-1"></a></span>
<span id="cb347-32"><a href="article-figures.html#cb347-32" tabindex="-1"></a>plot1_univariate_continuous</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="article-figures.html#cb348-1" tabindex="-1"></a><span class="do">## annotate plot with metrics</span></span>
<span id="cb348-2"><a href="article-figures.html#cb348-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb348-3"><a href="article-figures.html#cb348-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb348-4"><a href="article-figures.html#cb348-4" tabindex="-1"></a></span>
<span id="cb348-5"><a href="article-figures.html#cb348-5" tabindex="-1"></a><span class="co"># Add a significance level column based on p-value</span></span>
<span id="cb348-6"><a href="article-figures.html#cb348-6" tabindex="-1"></a>df_univariate_continuous <span class="ot">&lt;-</span> df_univariate_continuous <span class="sc">%&gt;%</span></span>
<span id="cb348-7"><a href="article-figures.html#cb348-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">significance =</span> <span class="fu">case_when</span>(</span>
<span id="cb348-8"><a href="article-figures.html#cb348-8" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">&quot;***&quot;</span>,</span>
<span id="cb348-9"><a href="article-figures.html#cb348-9" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;**&quot;</span>,</span>
<span id="cb348-10"><a href="article-figures.html#cb348-10" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;*&quot;</span>,</span>
<span id="cb348-11"><a href="article-figures.html#cb348-11" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;&quot;</span> <span class="co"># No asterisk if p-value is not significant</span></span>
<span id="cb348-12"><a href="article-figures.html#cb348-12" tabindex="-1"></a>  ))</span>
<span id="cb348-13"><a href="article-figures.html#cb348-13" tabindex="-1"></a></span>
<span id="cb348-14"><a href="article-figures.html#cb348-14" tabindex="-1"></a>signi_continuous_pos <span class="ot">&lt;-</span> df_univariate_continuous <span class="sc">|&gt;</span></span>
<span id="cb348-15"><a href="article-figures.html#cb348-15" tabindex="-1"></a>  <span class="fu">filter</span>(conf_int_5 <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb348-16"><a href="article-figures.html#cb348-16" tabindex="-1"></a></span>
<span id="cb348-17"><a href="article-figures.html#cb348-17" tabindex="-1"></a>signi_continuous_neg <span class="ot">&lt;-</span> df_univariate_continuous <span class="sc">|&gt;</span></span>
<span id="cb348-18"><a href="article-figures.html#cb348-18" tabindex="-1"></a>  <span class="fu">filter</span>(conf_int_95 <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb348-19"><a href="article-figures.html#cb348-19" tabindex="-1"></a></span>
<span id="cb348-20"><a href="article-figures.html#cb348-20" tabindex="-1"></a>df_univariate_continuous <span class="sc">|&gt;</span></span>
<span id="cb348-21"><a href="article-figures.html#cb348-21" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb348-22"><a href="article-figures.html#cb348-22" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb348-23"><a href="article-figures.html#cb348-23" tabindex="-1"></a>        <span class="at">y =</span> OR)</span>
<span id="cb348-24"><a href="article-figures.html#cb348-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb348-25"><a href="article-figures.html#cb348-25" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb348-26"><a href="article-figures.html#cb348-26" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(</span>
<span id="cb348-27"><a href="article-figures.html#cb348-27" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb348-28"><a href="article-figures.html#cb348-28" tabindex="-1"></a>      <span class="at">ymin =</span> conf_int_5, </span>
<span id="cb348-29"><a href="article-figures.html#cb348-29" tabindex="-1"></a>      <span class="at">ymax =</span> conf_int_95</span>
<span id="cb348-30"><a href="article-figures.html#cb348-30" tabindex="-1"></a>    )</span>
<span id="cb348-31"><a href="article-figures.html#cb348-31" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb348-32"><a href="article-figures.html#cb348-32" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> signi_continuous_pos, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb348-33"><a href="article-figures.html#cb348-33" tabindex="-1"></a>                <span class="at">y =</span> OR), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb348-34"><a href="article-figures.html#cb348-34" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb348-35"><a href="article-figures.html#cb348-35" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> signi_continuous_neg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb348-36"><a href="article-figures.html#cb348-36" tabindex="-1"></a>                <span class="at">y =</span> OR), <span class="at">colour =</span> <span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb348-37"><a href="article-figures.html#cb348-37" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb348-38"><a href="article-figures.html#cb348-38" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(significance), <span class="at">y =</span> OR <span class="sc">*</span> <span class="fl">1.0</span>), <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb348-39"><a href="article-figures.html#cb348-39" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variable&quot;</span>) <span class="sc">+</span></span>
<span id="cb348-40"><a href="article-figures.html#cb348-40" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;OR&quot;</span>) <span class="sc">+</span></span>
<span id="cb348-41"><a href="article-figures.html#cb348-41" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;darkred&#39;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb348-42"><a href="article-figures.html#cb348-42" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb348-43"><a href="article-figures.html#cb348-43" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Univariate - continuous&quot;</span>) <span class="sc">+</span></span>
<span id="cb348-44"><a href="article-figures.html#cb348-44" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="ot">-&gt;</span> plot1_univariate_continuous <span class="ot">-&gt;</span> plot1_univariate_continuous_annotated</span>
<span id="cb348-45"><a href="article-figures.html#cb348-45" tabindex="-1"></a></span>
<span id="cb348-46"><a href="article-figures.html#cb348-46" tabindex="-1"></a>plot1_univariate_continuous_annotated</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
</div>
<div id="relevel-dichotomous-variables-1" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Relevel dichotomous variables<a href="article-figures.html#relevel-dichotomous-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Univariate logistic regression for categorical and dichotomous variables.
Set the “1” or “0” of the variable as a reference category.
Fitting the univariate logistic regression.
Calculating the OR and CI of this model.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="article-figures.html#cb349-1" tabindex="-1"></a><span class="co"># Variable &quot;work&quot;</span></span>
<span id="cb349-2"><a href="article-figures.html#cb349-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>work <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>work, <span class="at">ref =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb349-3"><a href="article-figures.html#cb349-3" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> work, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb349-4"><a href="article-figures.html#cb349-4" tabindex="-1"></a>OR_work <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model1))</span>
<span id="cb349-5"><a href="article-figures.html#cb349-5" tabindex="-1"></a>CI_work <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model1))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="article-figures.html#cb351-1" tabindex="-1"></a><span class="fu">print</span>(OR_work)</span></code></pre></div>
<pre><code>## (Intercept)       work2 
##  0.09012876  2.95873016</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="article-figures.html#cb353-1" tabindex="-1"></a><span class="fu">print</span>(CI_work)</span></code></pre></div>
<pre><code>##                  2.5 %    97.5 %
## (Intercept) 0.06476482 0.1219859
## work2       1.62175793 5.2614647</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="article-figures.html#cb355-1" tabindex="-1"></a><span class="co"># Variable &quot;Education_level&quot;</span></span>
<span id="cb355-2"><a href="article-figures.html#cb355-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>education_level <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>education_level, <span class="at">ref =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb355-3"><a href="article-figures.html#cb355-3" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> education_level, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb355-4"><a href="article-figures.html#cb355-4" tabindex="-1"></a>OR_education_level <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model2))</span>
<span id="cb355-5"><a href="article-figures.html#cb355-5" tabindex="-1"></a>CI_education_level <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model2))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="article-figures.html#cb357-1" tabindex="-1"></a><span class="fu">print</span>(OR_education_level)</span></code></pre></div>
<pre><code>##      (Intercept) education_level0 
##        0.1058824        1.1557886</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="article-figures.html#cb359-1" tabindex="-1"></a><span class="fu">print</span>(CI_education_level)</span></code></pre></div>
<pre><code>##                       2.5 %    97.5 %
## (Intercept)      0.06960165 0.1543606
## education_level0 0.68231415 1.9770643</code></pre>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="article-figures.html#cb361-1" tabindex="-1"></a><span class="co"># Variable &quot;recurrence&quot;</span></span>
<span id="cb361-2"><a href="article-figures.html#cb361-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>recurrence <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>recurrence, <span class="at">ref =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb361-3"><a href="article-figures.html#cb361-3" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> recurrence, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb361-4"><a href="article-figures.html#cb361-4" tabindex="-1"></a>OR_recurrence <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model3))</span>
<span id="cb361-5"><a href="article-figures.html#cb361-5" tabindex="-1"></a>CI_recurrence <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model3))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="article-figures.html#cb363-1" tabindex="-1"></a><span class="fu">print</span>(OR_recurrence)</span></code></pre></div>
<pre><code>## (Intercept) recurrence2 
##   0.1061453   1.1190753</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="article-figures.html#cb365-1" tabindex="-1"></a><span class="fu">print</span>(CI_recurrence)</span></code></pre></div>
<pre><code>##                  2.5 %    97.5 %
## (Intercept) 0.06400102 0.1656877
## recurrence2 0.64242847 2.0165613</code></pre>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="article-figures.html#cb367-1" tabindex="-1"></a><span class="co"># Variable - pain in different body regions</span></span>
<span id="cb367-2"><a href="article-figures.html#cb367-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>pidbr <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>pidbr, <span class="at">ref =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb367-3"><a href="article-figures.html#cb367-3" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> pidbr, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb367-4"><a href="article-figures.html#cb367-4" tabindex="-1"></a>OR_pidbr <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model4))</span>
<span id="cb367-5"><a href="article-figures.html#cb367-5" tabindex="-1"></a>CI_pidbr <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model4))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="article-figures.html#cb369-1" tabindex="-1"></a><span class="fu">print</span>(OR_pidbr)</span></code></pre></div>
<pre><code>## (Intercept)      pidbr2 
##    0.055000    2.719275</code></pre>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="article-figures.html#cb371-1" tabindex="-1"></a><span class="fu">print</span>(CI_pidbr)</span></code></pre></div>
<pre><code>##                  2.5 %     97.5 %
## (Intercept) 0.02818785 0.09603279
## pidbr2      1.43692355 5.60887542</code></pre>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="article-figures.html#cb373-1" tabindex="-1"></a><span class="co"># Variable &quot;headache&quot;</span></span>
<span id="cb373-2"><a href="article-figures.html#cb373-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>headache <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>headache, <span class="at">ref =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb373-3"><a href="article-figures.html#cb373-3" tabindex="-1"></a>model5 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> headache, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb373-4"><a href="article-figures.html#cb373-4" tabindex="-1"></a>OR_headache <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model5))</span>
<span id="cb373-5"><a href="article-figures.html#cb373-5" tabindex="-1"></a>CI_headache <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model5))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="article-figures.html#cb375-1" tabindex="-1"></a><span class="fu">print</span>(OR_headache)</span></code></pre></div>
<pre><code>## (Intercept)   headache2   headache3 
##  0.05957447  2.99496147  1.29120879</code></pre>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="article-figures.html#cb377-1" tabindex="-1"></a><span class="fu">print</span>(CI_headache)</span></code></pre></div>
<pre><code>##                  2.5 %     97.5 %
## (Intercept) 0.03313328 0.09821967
## headache2   1.63503675 5.80948533
## headache3   0.40522908 3.51473465</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="article-figures.html#cb379-1" tabindex="-1"></a><span class="co"># Variable &quot;sex&quot;</span></span>
<span id="cb379-2"><a href="article-figures.html#cb379-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>sex, <span class="at">ref =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb379-3"><a href="article-figures.html#cb379-3" tabindex="-1"></a>model6 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> sex, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb379-4"><a href="article-figures.html#cb379-4" tabindex="-1"></a>OR_sex <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model6))</span>
<span id="cb379-5"><a href="article-figures.html#cb379-5" tabindex="-1"></a>CI_sex <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model6))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="article-figures.html#cb381-1" tabindex="-1"></a><span class="fu">print</span>(OR_sex)</span></code></pre></div>
<pre><code>## (Intercept)        sex2 
##  0.07291667  1.88620549</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="article-figures.html#cb383-1" tabindex="-1"></a><span class="fu">print</span>(CI_sex)</span></code></pre></div>
<pre><code>##                  2.5 %    97.5 %
## (Intercept) 0.04044007 0.1207022
## sex2        1.03994691 3.6326504</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="article-figures.html#cb385-1" tabindex="-1"></a><span class="co"># Variable &quot;Work_happiness&quot;</span></span>
<span id="cb385-2"><a href="article-figures.html#cb385-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>work_happiness <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>work_happiness, <span class="at">ref =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb385-3"><a href="article-figures.html#cb385-3" tabindex="-1"></a>model7 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> work_happiness, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb385-4"><a href="article-figures.html#cb385-4" tabindex="-1"></a>OR_work_happiness <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model7))</span>
<span id="cb385-5"><a href="article-figures.html#cb385-5" tabindex="-1"></a>CI_work_happiness <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model7))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="article-figures.html#cb387-1" tabindex="-1"></a><span class="fu">print</span>(OR_work_happiness)</span></code></pre></div>
<pre><code>##     (Intercept) work_happiness2 work_happiness3 
##      0.09803922      0.65504587      2.72000000</code></pre>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="article-figures.html#cb389-1" tabindex="-1"></a><span class="fu">print</span>(CI_work_happiness)</span></code></pre></div>
<pre><code>##                      2.5 %    97.5 %
## (Intercept)     0.06807407 0.1365982
## work_happiness2 0.26069153 1.4324050
## work_happiness3 1.46836240 4.9348410</code></pre>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="article-figures.html#cb391-1" tabindex="-1"></a><span class="co"># Variable &quot;posture_work&quot;</span></span>
<span id="cb391-2"><a href="article-figures.html#cb391-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>posture_work <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>posture_work, <span class="at">ref =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb391-3"><a href="article-figures.html#cb391-3" tabindex="-1"></a>model8 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> posture_work, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb391-4"><a href="article-figures.html#cb391-4" tabindex="-1"></a>OR_posture_work <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model8))</span>
<span id="cb391-5"><a href="article-figures.html#cb391-5" tabindex="-1"></a>CI_posture_work <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model8))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="article-figures.html#cb393-1" tabindex="-1"></a><span class="fu">print</span>(OR_posture_work)</span></code></pre></div>
<pre><code>##   (Intercept) posture_work2 posture_work3 
##    0.08379888    1.32592593    3.18222222</code></pre>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="article-figures.html#cb395-1" tabindex="-1"></a><span class="fu">print</span>(CI_posture_work)</span></code></pre></div>
<pre><code>##                    2.5 %    97.5 %
## (Intercept)   0.05653886 0.1194222
## posture_work2 0.63368447 2.6177321
## posture_work3 1.69613786 5.8757114</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="article-figures.html#cb397-1" tabindex="-1"></a><span class="co"># Variable &quot;work_satisfaction&quot;</span></span>
<span id="cb397-2"><a href="article-figures.html#cb397-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>work_satisfaction <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>work_satisfaction, <span class="at">ref =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb397-3"><a href="article-figures.html#cb397-3" tabindex="-1"></a>model9 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> work_satisfaction, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb397-4"><a href="article-figures.html#cb397-4" tabindex="-1"></a>OR_work_satisfaction <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model9))</span>
<span id="cb397-5"><a href="article-figures.html#cb397-5" tabindex="-1"></a>CI_work_satisfaction <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model9))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="article-figures.html#cb399-1" tabindex="-1"></a><span class="fu">print</span>(OR_work_satisfaction)</span></code></pre></div>
<pre><code>##        (Intercept) work_satisfaction2 work_satisfaction3 
##         0.09448819         0.74705882         2.82222222</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="article-figures.html#cb401-1" tabindex="-1"></a><span class="fu">print</span>(CI_work_satisfaction)</span></code></pre></div>
<pre><code>##                         2.5 %    97.5 %
## (Intercept)        0.06599362 0.1309863
## work_satisfaction2 0.27609334 1.7080924
## work_satisfaction3 1.52768147 5.1022741</code></pre>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="article-figures.html#cb403-1" tabindex="-1"></a><span class="co"># Variable &quot;physical Activity&quot;</span></span>
<span id="cb403-2"><a href="article-figures.html#cb403-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>physical_activity <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>physical_activity, <span class="at">ref =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb403-3"><a href="article-figures.html#cb403-3" tabindex="-1"></a>model10 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> physical_activity, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb403-4"><a href="article-figures.html#cb403-4" tabindex="-1"></a>OR_physical_activity <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model10))</span>
<span id="cb403-5"><a href="article-figures.html#cb403-5" tabindex="-1"></a>CI_physical_activity <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model10))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="article-figures.html#cb405-1" tabindex="-1"></a><span class="fu">print</span>(OR_physical_activity)</span></code></pre></div>
<pre><code>##        (Intercept) physical_activity1 
##           0.100000           1.231672</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="article-figures.html#cb407-1" tabindex="-1"></a><span class="fu">print</span>(CI_physical_activity)</span></code></pre></div>
<pre><code>##                        2.5 %    97.5 %
## (Intercept)        0.0611943 0.1542119
## physical_activity1 0.7119442 2.1964490</code></pre>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="article-figures.html#cb409-1" tabindex="-1"></a><span class="co"># Variable &quot;smoking&quot;</span></span>
<span id="cb409-2"><a href="article-figures.html#cb409-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>smoking <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>smoking, <span class="at">ref =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb409-3"><a href="article-figures.html#cb409-3" tabindex="-1"></a>model11 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> smoking, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb409-4"><a href="article-figures.html#cb409-4" tabindex="-1"></a>OR_smoking <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model11))</span>
<span id="cb409-5"><a href="article-figures.html#cb409-5" tabindex="-1"></a>CI_smoking <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model11))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="article-figures.html#cb411-1" tabindex="-1"></a><span class="fu">print</span>(OR_smoking)</span></code></pre></div>
<pre><code>## (Intercept)    smoking2 
##   0.1039501   1.9240000</code></pre>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="article-figures.html#cb413-1" tabindex="-1"></a><span class="fu">print</span>(CI_smoking)</span></code></pre></div>
<pre><code>##                  2.5 %    97.5 %
## (Intercept) 0.07674972 0.1375884
## smoking2    0.93299869 3.7113889</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="article-figures.html#cb415-1" tabindex="-1"></a><span class="co"># Variable &quot;alcohol&quot;</span></span>
<span id="cb415-2"><a href="article-figures.html#cb415-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>alcohol <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>alcohol, <span class="at">ref =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb415-3"><a href="article-figures.html#cb415-3" tabindex="-1"></a>model12 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> alcohol, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb415-4"><a href="article-figures.html#cb415-4" tabindex="-1"></a>OR_alcohol <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model12))</span>
<span id="cb415-5"><a href="article-figures.html#cb415-5" tabindex="-1"></a>CI_alcohol <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model12))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="article-figures.html#cb417-1" tabindex="-1"></a><span class="fu">print</span>(OR_alcohol)</span></code></pre></div>
<pre><code>## (Intercept)    alcohol2 
##   0.1517857   0.6910736</code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="article-figures.html#cb419-1" tabindex="-1"></a><span class="fu">print</span>(CI_alcohol)</span></code></pre></div>
<pre><code>##                  2.5 %    97.5 %
## (Intercept) 0.08795751 0.2456099
## alcohol2    0.38745282 1.2836914</code></pre>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="article-figures.html#cb421-1" tabindex="-1"></a><span class="co"># Variable &quot;sleep quality&quot;</span></span>
<span id="cb421-2"><a href="article-figures.html#cb421-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>sleep_quality <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>sleep_quality, <span class="at">ref =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb421-3"><a href="article-figures.html#cb421-3" tabindex="-1"></a>model13 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> sleep_quality, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb421-4"><a href="article-figures.html#cb421-4" tabindex="-1"></a>OR_sleep_quality <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model13))</span>
<span id="cb421-5"><a href="article-figures.html#cb421-5" tabindex="-1"></a>CI_sleep_quality <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model13))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="article-figures.html#cb423-1" tabindex="-1"></a><span class="fu">print</span>(OR_sleep_quality)</span></code></pre></div>
<pre><code>##    (Intercept) sleep_quality1 
##     0.09243697     1.30741060</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="article-figures.html#cb425-1" tabindex="-1"></a><span class="fu">print</span>(CI_sleep_quality)</span></code></pre></div>
<pre><code>##                     2.5 %    97.5 %
## (Intercept)    0.04696702 0.1635109
## sleep_quality1 0.68450097 2.7150269</code></pre>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="article-figures.html#cb427-1" tabindex="-1"></a><span class="co"># Variable &quot;coping&quot;</span></span>
<span id="cb427-2"><a href="article-figures.html#cb427-2" tabindex="-1"></a>imputed_with_attitude_and_chronic<span class="sc">$</span>coping <span class="ot">&lt;-</span> <span class="fu">relevel</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>coping, <span class="at">ref =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb427-3"><a href="article-figures.html#cb427-3" tabindex="-1"></a>model14 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> coping, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb427-4"><a href="article-figures.html#cb427-4" tabindex="-1"></a>OR_coping <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model14))</span>
<span id="cb427-5"><a href="article-figures.html#cb427-5" tabindex="-1"></a>CI_coping <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model14))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="article-figures.html#cb429-1" tabindex="-1"></a><span class="fu">print</span>(OR_coping)</span></code></pre></div>
<pre><code>## (Intercept)     coping1 
##  0.09909911  1.19682862</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="article-figures.html#cb431-1" tabindex="-1"></a><span class="fu">print</span>(CI_coping)</span></code></pre></div>
<pre><code>##                  2.5 %    97.5 %
## (Intercept) 0.05027562 0.1756983
## coping1     0.62546659 2.4886925</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="article-figures.html#cb433-1" tabindex="-1"></a><span class="co"># Variable &quot;attitude&quot;</span></span>
<span id="cb433-2"><a href="article-figures.html#cb433-2" tabindex="-1"></a>model15 <span class="ot">&lt;-</span> <span class="fu">glm</span>(is_painint_chronic <span class="sc">~</span> attitude, <span class="at">data =</span> imputed_with_attitude_and_chronic, <span class="at">family =</span> binomial)</span>
<span id="cb433-3"><a href="article-figures.html#cb433-3" tabindex="-1"></a>OR_attitude <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model15))</span>
<span id="cb433-4"><a href="article-figures.html#cb433-4" tabindex="-1"></a>CI_attitude <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(model15))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="article-figures.html#cb435-1" tabindex="-1"></a><span class="fu">print</span>(OR_attitude)</span></code></pre></div>
<pre><code>## (Intercept)    attitude 
##   0.1393033   0.9048630</code></pre>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="article-figures.html#cb437-1" tabindex="-1"></a><span class="fu">print</span>(CI_attitude)</span></code></pre></div>
<pre><code>##                  2.5 %    97.5 %
## (Intercept) 0.04214516 0.4017094
## attitude    0.49543972 1.7361149</code></pre>
</div>
<div id="refactor-code-above-to-a-more-compact-version" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Refactor code above to a more compact version<a href="article-figures.html#refactor-code-above-to-a-more-compact-version" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="article-figures.html#cb439-1" tabindex="-1"></a><span class="co"># Your named vector of reference levels</span></span>
<span id="cb439-2"><a href="article-figures.html#cb439-2" tabindex="-1"></a>reference_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">work =</span> <span class="st">&quot;1&quot;</span>, </span>
<span id="cb439-3"><a href="article-figures.html#cb439-3" tabindex="-1"></a>                      <span class="at">education_level =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb439-4"><a href="article-figures.html#cb439-4" tabindex="-1"></a>                      <span class="at">recurrence =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb439-5"><a href="article-figures.html#cb439-5" tabindex="-1"></a>                      <span class="at">pidbr =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb439-6"><a href="article-figures.html#cb439-6" tabindex="-1"></a>                      <span class="at">headache =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb439-7"><a href="article-figures.html#cb439-7" tabindex="-1"></a>                      <span class="at">sex =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb439-8"><a href="article-figures.html#cb439-8" tabindex="-1"></a>                      <span class="at">work_happiness =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb439-9"><a href="article-figures.html#cb439-9" tabindex="-1"></a>                      <span class="at">posture_work =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb439-10"><a href="article-figures.html#cb439-10" tabindex="-1"></a>                      <span class="at">work_satisfaction =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb439-11"><a href="article-figures.html#cb439-11" tabindex="-1"></a>                      <span class="at">physical_activity =</span> <span class="st">&quot;0&quot;</span>,  <span class="co"># Note that this is set to &quot;0&quot;</span></span>
<span id="cb439-12"><a href="article-figures.html#cb439-12" tabindex="-1"></a>                      <span class="at">smoking =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb439-13"><a href="article-figures.html#cb439-13" tabindex="-1"></a>                      <span class="at">alcohol =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb439-14"><a href="article-figures.html#cb439-14" tabindex="-1"></a>                      <span class="at">sleep_quality =</span> <span class="st">&quot;0&quot;</span>,  <span class="co"># Note that this is set to &quot;0&quot;</span></span>
<span id="cb439-15"><a href="article-figures.html#cb439-15" tabindex="-1"></a>                      <span class="at">coping =</span> <span class="st">&quot;0&quot;</span>)  <span class="co"># Note that this is set to &quot;0&quot;</span></span>
<span id="cb439-16"><a href="article-figures.html#cb439-16" tabindex="-1"></a></span>
<span id="cb439-17"><a href="article-figures.html#cb439-17" tabindex="-1"></a><span class="co"># Ensure all relevant variables are factors</span></span>
<span id="cb439-18"><a href="article-figures.html#cb439-18" tabindex="-1"></a>imputed_with_attitude_and_chronic[ <span class="fu">names</span>(reference_levels) ] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(imputed_with_attitude_and_chronic[ <span class="fu">names</span>(reference_levels) ], as.factor)</span>
<span id="cb439-19"><a href="article-figures.html#cb439-19" tabindex="-1"></a></span>
<span id="cb439-20"><a href="article-figures.html#cb439-20" tabindex="-1"></a><span class="co"># subset data for categorical variables only</span></span>
<span id="cb439-21"><a href="article-figures.html#cb439-21" tabindex="-1"></a>data_categorical <span class="ot">&lt;-</span> imputed_with_attitude_and_chronic <span class="sc">|&gt;</span></span>
<span id="cb439-22"><a href="article-figures.html#cb439-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">names</span>(reference_levels))</span>
<span id="cb439-23"><a href="article-figures.html#cb439-23" tabindex="-1"></a></span>
<span id="cb439-24"><a href="article-figures.html#cb439-24" tabindex="-1"></a><span class="co"># Iterate over the variables using map() and relevel</span></span>
<span id="cb439-25"><a href="article-figures.html#cb439-25" tabindex="-1"></a>data_categorical <span class="ot">&lt;-</span> data_categorical <span class="sc">%&gt;%</span></span>
<span id="cb439-26"><a href="article-figures.html#cb439-26" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map2_df</span>(., reference_levels, <span class="sc">~</span><span class="fu">relevel</span>(.x, <span class="at">ref =</span> .y))</span>
<span id="cb439-27"><a href="article-figures.html#cb439-27" tabindex="-1"></a></span>
<span id="cb439-28"><a href="article-figures.html#cb439-28" tabindex="-1"></a>data_categorical<span class="sc">$</span>is_painint_chronic <span class="ot">&lt;-</span> imputed_with_attitude_and_chronic<span class="sc">$</span>is_painint_chronic</span></code></pre></div>
</div>
<div id="univariate-analysis-on-the-categorical-variables" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> Univariate analysis on the categorical variables<a href="article-figures.html#univariate-analysis-on-the-categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="article-figures.html#cb440-1" tabindex="-1"></a>df_univariate_categorical <span class="ot">&lt;-</span> <span class="fu">map_df</span>(</span>
<span id="cb440-2"><a href="article-figures.html#cb440-2" tabindex="-1"></a>  <span class="at">.x =</span> <span class="fu">names</span>(reference_levels),</span>
<span id="cb440-3"><a href="article-figures.html#cb440-3" tabindex="-1"></a>  <span class="at">.f =</span> univariate_analysis,</span>
<span id="cb440-4"><a href="article-figures.html#cb440-4" tabindex="-1"></a>  <span class="at">data =</span> data_categorical</span>
<span id="cb440-5"><a href="article-figures.html#cb440-5" tabindex="-1"></a>  )</span>
<span id="cb440-6"><a href="article-figures.html#cb440-6" tabindex="-1"></a></span>
<span id="cb440-7"><a href="article-figures.html#cb440-7" tabindex="-1"></a>df_univariate_categorical</span></code></pre></div>
<pre><code>## # A tibble: 18 × 8
##    term        estimate std.error statistic p.value conf_int_5    OR conf_int_95
##    &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
##  1 work2          1.08      0.299     3.63  2.83e-4      1.65  2.96         5.31
##  2 education_…    0.145     0.270     0.536 5.92e-1      0.681 1.16         1.96
##  3 recurrence2    0.113     0.290     0.388 6.98e-1      0.634 1.12         1.98
##  4 pidbr2         1.00      0.344     2.91  3.65e-3      1.39  2.72         5.34
##  5 headache2      1.10      0.321     3.42  6.34e-4      1.60  2.99         5.62
##  6 headache3      0.256     0.540     0.474 6.36e-1      0.448 1.29         3.72
##  7 sex2           0.635     0.317     2.00  4.51e-2      1.01  1.89         3.51
##  8 work_happi…   -0.423     0.428    -0.988 3.23e-1      0.283 0.655        1.52
##  9 work_happi…    1.00      0.308     3.25  1.15e-3      1.49  2.72         4.97
## 10 posture_wo…    0.282     0.359     0.786 4.32e-1      0.656 1.33         2.68
## 11 posture_wo…    1.16      0.315     3.67  2.42e-4      1.72  3.18         5.90
## 12 work_satis…   -0.292     0.457    -0.638 5.23e-1      0.305 0.747        1.83
## 13 work_satis…    1.04      0.306     3.39  7.02e-4      1.55  2.82         5.14
## 14 physical_a…    0.208     0.286     0.729 4.66e-1      0.703 1.23         2.16
## 15 smoking2       0.654     0.349     1.87  6.11e-2      0.970 1.92         3.82
## 16 alcohol2      -0.370     0.304    -1.22  2.24e-1      0.381 0.691        1.25
## 17 sleep_qual…    0.268     0.348     0.770 4.41e-1      0.661 1.31         2.59
## 18 coping1        0.180     0.349     0.515 6.07e-1      0.604 1.20         2.37</code></pre>
</div>
<div id="visualize-model-outcome" class="section level2 hasAnchor" number="5.10">
<h2><span class="header-section-number">5.10</span> Visualize model outcome<a href="article-figures.html#visualize-model-outcome" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="article-figures.html#cb442-1" tabindex="-1"></a>signi_categorical_pos <span class="ot">&lt;-</span> df_univariate_categorical <span class="sc">|&gt;</span></span>
<span id="cb442-2"><a href="article-figures.html#cb442-2" tabindex="-1"></a>  <span class="fu">filter</span>(conf_int_5 <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb442-3"><a href="article-figures.html#cb442-3" tabindex="-1"></a></span>
<span id="cb442-4"><a href="article-figures.html#cb442-4" tabindex="-1"></a>signi_categorical_neg <span class="ot">&lt;-</span> df_univariate_categorical <span class="sc">|&gt;</span></span>
<span id="cb442-5"><a href="article-figures.html#cb442-5" tabindex="-1"></a>  <span class="fu">filter</span>(conf_int_95 <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb442-6"><a href="article-figures.html#cb442-6" tabindex="-1"></a></span>
<span id="cb442-7"><a href="article-figures.html#cb442-7" tabindex="-1"></a></span>
<span id="cb442-8"><a href="article-figures.html#cb442-8" tabindex="-1"></a>df_univariate_categorical <span class="sc">|&gt;</span></span>
<span id="cb442-9"><a href="article-figures.html#cb442-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb442-10"><a href="article-figures.html#cb442-10" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb442-11"><a href="article-figures.html#cb442-11" tabindex="-1"></a>        <span class="at">y =</span> OR)</span>
<span id="cb442-12"><a href="article-figures.html#cb442-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb442-13"><a href="article-figures.html#cb442-13" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb442-14"><a href="article-figures.html#cb442-14" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(</span>
<span id="cb442-15"><a href="article-figures.html#cb442-15" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb442-16"><a href="article-figures.html#cb442-16" tabindex="-1"></a>      <span class="at">ymin =</span> conf_int_5, </span>
<span id="cb442-17"><a href="article-figures.html#cb442-17" tabindex="-1"></a>      <span class="at">ymax =</span> conf_int_95</span>
<span id="cb442-18"><a href="article-figures.html#cb442-18" tabindex="-1"></a>      )</span>
<span id="cb442-19"><a href="article-figures.html#cb442-19" tabindex="-1"></a>    )  <span class="sc">+</span></span>
<span id="cb442-20"><a href="article-figures.html#cb442-20" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> signi_categorical_pos, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb442-21"><a href="article-figures.html#cb442-21" tabindex="-1"></a>                <span class="at">y =</span> OR), <span class="at">colour =</span> <span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb442-22"><a href="article-figures.html#cb442-22" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb442-23"><a href="article-figures.html#cb442-23" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> signi_categorical_neg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb442-24"><a href="article-figures.html#cb442-24" tabindex="-1"></a>                <span class="at">y =</span> OR), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb442-25"><a href="article-figures.html#cb442-25" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb442-26"><a href="article-figures.html#cb442-26" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variable&quot;</span>) <span class="sc">+</span></span>
<span id="cb442-27"><a href="article-figures.html#cb442-27" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;OR&quot;</span>) <span class="sc">+</span></span>
<span id="cb442-28"><a href="article-figures.html#cb442-28" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Univariate - categorical&quot;</span>) <span class="sc">+</span></span>
<span id="cb442-29"><a href="article-figures.html#cb442-29" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">colour  =</span> <span class="st">&#39;darkred&#39;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb442-30"><a href="article-figures.html#cb442-30" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="ot">-&gt;</span> plot2_univariate_categorical</span>
<span id="cb442-31"><a href="article-figures.html#cb442-31" tabindex="-1"></a>plot2_univariate_categorical</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="article-figures.html#cb443-1" tabindex="-1"></a><span class="do">## annotate plot with * for significance</span></span>
<span id="cb443-2"><a href="article-figures.html#cb443-2" tabindex="-1"></a><span class="co"># Add a significance level column based on p-value</span></span>
<span id="cb443-3"><a href="article-figures.html#cb443-3" tabindex="-1"></a>df_univariate_categorical <span class="ot">&lt;-</span> df_univariate_categorical <span class="sc">%&gt;%</span></span>
<span id="cb443-4"><a href="article-figures.html#cb443-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">significance =</span> <span class="fu">case_when</span>(</span>
<span id="cb443-5"><a href="article-figures.html#cb443-5" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">&quot;***&quot;</span>,</span>
<span id="cb443-6"><a href="article-figures.html#cb443-6" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;**&quot;</span>,</span>
<span id="cb443-7"><a href="article-figures.html#cb443-7" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;*&quot;</span>,</span>
<span id="cb443-8"><a href="article-figures.html#cb443-8" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;&quot;</span> <span class="co"># No asterisk if p-value is not significant</span></span>
<span id="cb443-9"><a href="article-figures.html#cb443-9" tabindex="-1"></a>  ))</span>
<span id="cb443-10"><a href="article-figures.html#cb443-10" tabindex="-1"></a></span>
<span id="cb443-11"><a href="article-figures.html#cb443-11" tabindex="-1"></a>signi_continuous_pos <span class="ot">&lt;-</span> df_univariate_categorical <span class="sc">|&gt;</span></span>
<span id="cb443-12"><a href="article-figures.html#cb443-12" tabindex="-1"></a>  <span class="fu">filter</span>(conf_int_5 <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb443-13"><a href="article-figures.html#cb443-13" tabindex="-1"></a></span>
<span id="cb443-14"><a href="article-figures.html#cb443-14" tabindex="-1"></a>signi_continuous_neg <span class="ot">&lt;-</span> df_univariate_categorical <span class="sc">|&gt;</span></span>
<span id="cb443-15"><a href="article-figures.html#cb443-15" tabindex="-1"></a>  <span class="fu">filter</span>(conf_int_95 <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb443-16"><a href="article-figures.html#cb443-16" tabindex="-1"></a></span>
<span id="cb443-17"><a href="article-figures.html#cb443-17" tabindex="-1"></a>df_univariate_categorical <span class="sc">|&gt;</span></span>
<span id="cb443-18"><a href="article-figures.html#cb443-18" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb443-19"><a href="article-figures.html#cb443-19" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb443-20"><a href="article-figures.html#cb443-20" tabindex="-1"></a>        <span class="at">y =</span> OR)</span>
<span id="cb443-21"><a href="article-figures.html#cb443-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb443-22"><a href="article-figures.html#cb443-22" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb443-23"><a href="article-figures.html#cb443-23" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(</span>
<span id="cb443-24"><a href="article-figures.html#cb443-24" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb443-25"><a href="article-figures.html#cb443-25" tabindex="-1"></a>      <span class="at">ymin =</span> conf_int_5, </span>
<span id="cb443-26"><a href="article-figures.html#cb443-26" tabindex="-1"></a>      <span class="at">ymax =</span> conf_int_95</span>
<span id="cb443-27"><a href="article-figures.html#cb443-27" tabindex="-1"></a>    )</span>
<span id="cb443-28"><a href="article-figures.html#cb443-28" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb443-29"><a href="article-figures.html#cb443-29" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> signi_categorical_pos, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb443-30"><a href="article-figures.html#cb443-30" tabindex="-1"></a>                <span class="at">y =</span> OR), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb443-31"><a href="article-figures.html#cb443-31" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb443-32"><a href="article-figures.html#cb443-32" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> signi_categorical_neg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb443-33"><a href="article-figures.html#cb443-33" tabindex="-1"></a>                <span class="at">y =</span> OR), <span class="at">colour =</span> <span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb443-34"><a href="article-figures.html#cb443-34" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb443-35"><a href="article-figures.html#cb443-35" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(significance), <span class="at">y =</span> OR <span class="sc">*</span> <span class="fl">1.0</span>), <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb443-36"><a href="article-figures.html#cb443-36" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variable&quot;</span>) <span class="sc">+</span></span>
<span id="cb443-37"><a href="article-figures.html#cb443-37" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;OR&quot;</span>) <span class="sc">+</span></span>
<span id="cb443-38"><a href="article-figures.html#cb443-38" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&#39;darkred&#39;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb443-39"><a href="article-figures.html#cb443-39" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb443-40"><a href="article-figures.html#cb443-40" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Univariate - categorical&quot;</span>) <span class="sc">+</span></span>
<span id="cb443-41"><a href="article-figures.html#cb443-41" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="ot">-&gt;</span> plot2_univariate_categorical_annotated</span>
<span id="cb443-42"><a href="article-figures.html#cb443-42" tabindex="-1"></a></span>
<span id="cb443-43"><a href="article-figures.html#cb443-43" tabindex="-1"></a>plot2_univariate_categorical_annotated</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
</div>
<div id="panel-plot-univariate" class="section level2 hasAnchor" number="5.11">
<h2><span class="header-section-number">5.11</span> Panel plot univariate<a href="article-figures.html#panel-plot-univariate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="article-figures.html#cb444-1" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb444-2"><a href="article-figures.html#cb444-2" tabindex="-1"></a>  <span class="at">plotlist =</span> <span class="fu">list</span>(</span>
<span id="cb444-3"><a href="article-figures.html#cb444-3" tabindex="-1"></a>    plot1_univariate_continuous_annotated <span class="sc">+</span> painr<span class="sc">::</span><span class="fu">theme_individual</span>(), </span>
<span id="cb444-4"><a href="article-figures.html#cb444-4" tabindex="-1"></a>    plot2_univariate_categorical_annotated <span class="sc">+</span> painr<span class="sc">::</span><span class="fu">theme_individual</span>())</span>
<span id="cb444-5"><a href="article-figures.html#cb444-5" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="multivariable-logistic-regression-analyses-1" class="section level2 hasAnchor" number="5.12">
<h2><span class="header-section-number">5.12</span> Multivariable logistic regression analyses<a href="article-figures.html#multivariable-logistic-regression-analyses-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Due to multicollinearity in the work-related factors (happiness, satisfaction, and posture -&gt; leading to the outcome “3” = not working), a decision had to be made on which factor to include. We analysed different models with the individual work-related factors included. There was almost no difference in model performance. Because happiness and satisfaction align more with the other psychological factors, we have chosen to include the variable “posture_work”, thereby incorporating add different domain into our model for the final backward model analyses and internal validation.</p>
<p>The candidate prognostic factor “attitude” does not have predictive value in het univariate analysis and does not emerge in the multivariate analysis in the formula with all the variables included. Additionally, there are many missing values, which cannot be imputed, as they pertain to the the therapist’s attitude. We now excluding this variable from the complete model development because internal validation does not proceed with these variables included.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="article-figures.html#cb445-1" tabindex="-1"></a>naniar<span class="sc">::</span><span class="fu">vis_miss</span>(imputed_with_attitude_and_chronic)</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="article-figures.html#cb446-1" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> imputed_with_attitude_and_chronic <span class="sc">|&gt;</span></span>
<span id="cb446-2"><a href="article-figures.html#cb446-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>attitude)</span>
<span id="cb446-3"><a href="article-figures.html#cb446-3" tabindex="-1"></a></span>
<span id="cb446-4"><a href="article-figures.html#cb446-4" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(new_data))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="article-figures.html#cb448-1" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data =</span> imputed_with_attitude_and_chronic, is_painint_chronic <span class="sc">~</span> sex <span class="sc">+</span> age <span class="sc">+</span> pain_intensity <span class="sc">+</span> duration <span class="sc">+</span> pidbr <span class="sc">+</span> headache <span class="sc">+</span> disability <span class="sc">+</span> posture_work <span class="sc">+</span> physical_activity <span class="sc">+</span> smoking <span class="sc">+</span> alcohol <span class="sc">+</span> bmi <span class="sc">+</span> sleep_quality <span class="sc">+</span> catastrophizing <span class="sc">+</span> duration_beliefs <span class="sc">+</span> concerns <span class="sc">+</span> treatment_beliefs <span class="sc">+</span> depression <span class="sc">+</span> kinesiophobia <span class="sc">+</span> distress <span class="sc">+</span> coping <span class="sc">+</span> identity_beliefs <span class="sc">+</span> hypervigilance <span class="sc">+</span> self_efficacy <span class="sc">+</span> relation, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb448-2"><a href="article-figures.html#cb448-2" tabindex="-1"></a></span>
<span id="cb448-3"><a href="article-figures.html#cb448-3" tabindex="-1"></a><span class="fu">summary</span>(full_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = is_painint_chronic ~ sex + age + pain_intensity + 
##     duration + pidbr + headache + disability + posture_work + 
##     physical_activity + smoking + alcohol + bmi + sleep_quality + 
##     catastrophizing + duration_beliefs + concerns + treatment_beliefs + 
##     depression + kinesiophobia + distress + coping + identity_beliefs + 
##     hypervigilance + self_efficacy + relation, family = &quot;binomial&quot;, 
##     data = imputed_with_attitude_and_chronic)
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        -7.856997   2.014554  -3.900 9.61e-05 ***
## sex2                0.621459   0.381164   1.630 0.103012    
## age                 0.007465   0.011387   0.656 0.512097    
## pain_intensity      0.257560   0.115333   2.233 0.025537 *  
## duration            0.055364   0.053130   1.042 0.297391    
## pidbr2              0.809406   0.399367   2.027 0.042691 *  
## headache2           0.961491   0.380336   2.528 0.011471 *  
## headache3          -0.017406   0.611967  -0.028 0.977309    
## disability          0.037170   0.091565   0.406 0.684787    
## posture_work2       0.705919   0.421910   1.673 0.094297 .  
## posture_work3       1.523283   0.433345   3.515 0.000439 ***
## physical_activity1  0.164670   0.348018   0.473 0.636095    
## smoking2            0.563160   0.418249   1.346 0.178151    
## alcohol2           -0.302294   0.368041  -0.821 0.411441    
## bmi                 0.019959   0.036600   0.545 0.585528    
## sleep_quality1     -0.503916   0.421602  -1.195 0.231993    
## catastrophizing    -0.057224   0.048013  -1.192 0.233326    
## duration_beliefs    0.238992   0.065878   3.628 0.000286 ***
## concerns            0.183421   0.083870   2.187 0.028745 *  
## treatment_beliefs  -0.219190   0.098053  -2.235 0.025389 *  
## depression          0.017426   0.065927   0.264 0.791528    
## kinesiophobia      -0.007644   0.039061  -0.196 0.844841    
## distress            0.113553   0.056189   2.021 0.043290 *  
## coping1             0.459219   0.429294   1.070 0.284751    
## identity_beliefs   -0.163266   0.075735  -2.156 0.031102 *  
## hypervigilance      0.007581   0.016849   0.450 0.652743    
## self_efficacy       0.137327   0.085300   1.610 0.107416    
## relation           -0.060274   0.123675  -0.487 0.626003    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 399.47  on 602  degrees of freedom
## Residual deviance: 292.30  on 575  degrees of freedom
## AIC: 348.3
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="article-figures.html#cb450-1" tabindex="-1"></a><span class="co">#full_model_mterics_df &lt;- full_model |&gt; broom::tidy()</span></span>
<span id="cb450-2"><a href="article-figures.html#cb450-2" tabindex="-1"></a><span class="co">#full_model_mterics_df &lt;- full_model_mterics_df |&gt;</span></span>
<span id="cb450-3"><a href="article-figures.html#cb450-3" tabindex="-1"></a></span>
<span id="cb450-4"><a href="article-figures.html#cb450-4" tabindex="-1"></a>  </span>
<span id="cb450-5"><a href="article-figures.html#cb450-5" tabindex="-1"></a><span class="do">## Run a tidy version of the full model  </span></span>
<span id="cb450-6"><a href="article-figures.html#cb450-6" tabindex="-1"></a><span class="co">#&#39; @title Run an univariate model for all continuous variables in the data</span></span>
<span id="cb450-7"><a href="article-figures.html#cb450-7" tabindex="-1"></a><span class="co">#&#39; @param variable Name of variable as a character string</span></span>
<span id="cb450-8"><a href="article-figures.html#cb450-8" tabindex="-1"></a><span class="co">#&#39; @param data Dataset &#39;imputed_with_attitude_and_chronic&#39;</span></span>
<span id="cb450-9"><a href="article-figures.html#cb450-9" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb450-10"><a href="article-figures.html#cb450-10" tabindex="-1"></a></span>
<span id="cb450-11"><a href="article-figures.html#cb450-11" tabindex="-1"></a>multivariate_analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb450-12"><a href="article-figures.html#cb450-12" tabindex="-1"></a>    data, </span>
<span id="cb450-13"><a href="article-figures.html#cb450-13" tabindex="-1"></a>    <span class="at">z_score =</span> <span class="fl">1.96</span>, </span>
<span id="cb450-14"><a href="article-figures.html#cb450-14" tabindex="-1"></a>    <span class="at">conf_int =</span> <span class="dv">95</span>) {</span>
<span id="cb450-15"><a href="article-figures.html#cb450-15" tabindex="-1"></a>  </span>
<span id="cb450-16"><a href="article-figures.html#cb450-16" tabindex="-1"></a>  full_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb450-17"><a href="article-figures.html#cb450-17" tabindex="-1"></a>    <span class="at">data =</span> data, </span>
<span id="cb450-18"><a href="article-figures.html#cb450-18" tabindex="-1"></a>    is_painint_chronic <span class="sc">~</span> </span>
<span id="cb450-19"><a href="article-figures.html#cb450-19" tabindex="-1"></a>      sex <span class="sc">+</span> </span>
<span id="cb450-20"><a href="article-figures.html#cb450-20" tabindex="-1"></a>      age <span class="sc">+</span> </span>
<span id="cb450-21"><a href="article-figures.html#cb450-21" tabindex="-1"></a>      pain_intensity <span class="sc">+</span> </span>
<span id="cb450-22"><a href="article-figures.html#cb450-22" tabindex="-1"></a>      duration <span class="sc">+</span> </span>
<span id="cb450-23"><a href="article-figures.html#cb450-23" tabindex="-1"></a>      pidbr <span class="sc">+</span> </span>
<span id="cb450-24"><a href="article-figures.html#cb450-24" tabindex="-1"></a>      headache <span class="sc">+</span> </span>
<span id="cb450-25"><a href="article-figures.html#cb450-25" tabindex="-1"></a>      disability <span class="sc">+</span> </span>
<span id="cb450-26"><a href="article-figures.html#cb450-26" tabindex="-1"></a>      posture_work <span class="sc">+</span> </span>
<span id="cb450-27"><a href="article-figures.html#cb450-27" tabindex="-1"></a>      physical_activity <span class="sc">+</span> </span>
<span id="cb450-28"><a href="article-figures.html#cb450-28" tabindex="-1"></a>      smoking <span class="sc">+</span> </span>
<span id="cb450-29"><a href="article-figures.html#cb450-29" tabindex="-1"></a>      alcohol <span class="sc">+</span> </span>
<span id="cb450-30"><a href="article-figures.html#cb450-30" tabindex="-1"></a>      bmi <span class="sc">+</span> </span>
<span id="cb450-31"><a href="article-figures.html#cb450-31" tabindex="-1"></a>      sleep_quality <span class="sc">+</span> </span>
<span id="cb450-32"><a href="article-figures.html#cb450-32" tabindex="-1"></a>      catastrophizing <span class="sc">+</span> </span>
<span id="cb450-33"><a href="article-figures.html#cb450-33" tabindex="-1"></a>      duration_beliefs <span class="sc">+</span> </span>
<span id="cb450-34"><a href="article-figures.html#cb450-34" tabindex="-1"></a>      concerns <span class="sc">+</span> </span>
<span id="cb450-35"><a href="article-figures.html#cb450-35" tabindex="-1"></a>      treatment_beliefs <span class="sc">+</span> </span>
<span id="cb450-36"><a href="article-figures.html#cb450-36" tabindex="-1"></a>      depression <span class="sc">+</span> </span>
<span id="cb450-37"><a href="article-figures.html#cb450-37" tabindex="-1"></a>      kinesiophobia <span class="sc">+</span> </span>
<span id="cb450-38"><a href="article-figures.html#cb450-38" tabindex="-1"></a>      distress <span class="sc">+</span> </span>
<span id="cb450-39"><a href="article-figures.html#cb450-39" tabindex="-1"></a>      coping <span class="sc">+</span> </span>
<span id="cb450-40"><a href="article-figures.html#cb450-40" tabindex="-1"></a>      identity_beliefs <span class="sc">+</span> </span>
<span id="cb450-41"><a href="article-figures.html#cb450-41" tabindex="-1"></a>      hypervigilance <span class="sc">+</span> </span>
<span id="cb450-42"><a href="article-figures.html#cb450-42" tabindex="-1"></a>      self_efficacy <span class="sc">+</span> </span>
<span id="cb450-43"><a href="article-figures.html#cb450-43" tabindex="-1"></a>      relation, </span>
<span id="cb450-44"><a href="article-figures.html#cb450-44" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb450-45"><a href="article-figures.html#cb450-45" tabindex="-1"></a> </span>
<span id="cb450-46"><a href="article-figures.html#cb450-46" tabindex="-1"></a>  conf_int_upper_limit <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;conf_int_&quot;</span>, conf_int)</span>
<span id="cb450-47"><a href="article-figures.html#cb450-47" tabindex="-1"></a>  conf_int_lower_limit <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;conf_int_&quot;</span>, (<span class="dv">100</span><span class="sc">-</span>conf_int))</span>
<span id="cb450-48"><a href="article-figures.html#cb450-48" tabindex="-1"></a>  </span>
<span id="cb450-49"><a href="article-figures.html#cb450-49" tabindex="-1"></a>  <span class="co"># get model meterics with broom</span></span>
<span id="cb450-50"><a href="article-figures.html#cb450-50" tabindex="-1"></a>  full_model <span class="sc">|&gt;</span> </span>
<span id="cb450-51"><a href="article-figures.html#cb450-51" tabindex="-1"></a>    broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb450-52"><a href="article-figures.html#cb450-52" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb450-53"><a href="article-figures.html#cb450-53" tabindex="-1"></a>      <span class="at">conf_int_lower =</span> <span class="fu">exp</span>(estimate <span class="sc">-</span> z_score <span class="sc">*</span> std.error),</span>
<span id="cb450-54"><a href="article-figures.html#cb450-54" tabindex="-1"></a>      <span class="at">OR =</span> <span class="fu">exp</span>(estimate),</span>
<span id="cb450-55"><a href="article-figures.html#cb450-55" tabindex="-1"></a>      <span class="at">conf_int_upper =</span> <span class="fu">exp</span>(</span>
<span id="cb450-56"><a href="article-figures.html#cb450-56" tabindex="-1"></a>        estimate <span class="sc">+</span> z_score <span class="sc">*</span> std.error)) <span class="ot">-&gt;</span> df</span>
<span id="cb450-57"><a href="article-figures.html#cb450-57" tabindex="-1"></a>  </span>
<span id="cb450-58"><a href="article-figures.html#cb450-58" tabindex="-1"></a>  <span class="fu">names</span>(df)[<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(conf_int_lower_limit, conf_int_upper_limit)</span>
<span id="cb450-59"><a href="article-figures.html#cb450-59" tabindex="-1"></a>  df</span>
<span id="cb450-60"><a href="article-figures.html#cb450-60" tabindex="-1"></a>  <span class="co"># remove Intercept term</span></span>
<span id="cb450-61"><a href="article-figures.html#cb450-61" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb450-62"><a href="article-figures.html#cb450-62" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb450-63"><a href="article-figures.html#cb450-63" tabindex="-1"></a>}</span>
<span id="cb450-64"><a href="article-figures.html#cb450-64" tabindex="-1"></a></span>
<span id="cb450-65"><a href="article-figures.html#cb450-65" tabindex="-1"></a><span class="do">## full model</span></span>
<span id="cb450-66"><a href="article-figures.html#cb450-66" tabindex="-1"></a>full_model_tidy <span class="ot">&lt;-</span> <span class="fu">multivariate_analysis</span>(</span>
<span id="cb450-67"><a href="article-figures.html#cb450-67" tabindex="-1"></a>  <span class="at">data =</span> imputed_with_attitude_and_chronic</span>
<span id="cb450-68"><a href="article-figures.html#cb450-68" tabindex="-1"></a>)</span>
<span id="cb450-69"><a href="article-figures.html#cb450-69" tabindex="-1"></a></span>
<span id="cb450-70"><a href="article-figures.html#cb450-70" tabindex="-1"></a></span>
<span id="cb450-71"><a href="article-figures.html#cb450-71" tabindex="-1"></a> full_model_tidy <span class="ot">&lt;-</span> full_model_tidy <span class="sc">%&gt;%</span></span>
<span id="cb450-72"><a href="article-figures.html#cb450-72" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">significance =</span> <span class="fu">case_when</span>(</span>
<span id="cb450-73"><a href="article-figures.html#cb450-73" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">&quot;***&quot;</span>,</span>
<span id="cb450-74"><a href="article-figures.html#cb450-74" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;**&quot;</span>,</span>
<span id="cb450-75"><a href="article-figures.html#cb450-75" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;*&quot;</span>,</span>
<span id="cb450-76"><a href="article-figures.html#cb450-76" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;&quot;</span> <span class="co"># No asterisk if p-value is not significant</span></span>
<span id="cb450-77"><a href="article-figures.html#cb450-77" tabindex="-1"></a>  ))</span>
<span id="cb450-78"><a href="article-figures.html#cb450-78" tabindex="-1"></a></span>
<span id="cb450-79"><a href="article-figures.html#cb450-79" tabindex="-1"></a></span>
<span id="cb450-80"><a href="article-figures.html#cb450-80" tabindex="-1"></a><span class="do">## Visualize</span></span>
<span id="cb450-81"><a href="article-figures.html#cb450-81" tabindex="-1"></a>signi_full_pos <span class="ot">&lt;-</span> full_model_tidy <span class="sc">|&gt;</span></span>
<span id="cb450-82"><a href="article-figures.html#cb450-82" tabindex="-1"></a>  <span class="fu">filter</span>(conf_int_5 <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb450-83"><a href="article-figures.html#cb450-83" tabindex="-1"></a></span>
<span id="cb450-84"><a href="article-figures.html#cb450-84" tabindex="-1"></a>signi_full_neg <span class="ot">&lt;-</span> full_model_tidy <span class="sc">|&gt;</span></span>
<span id="cb450-85"><a href="article-figures.html#cb450-85" tabindex="-1"></a>  <span class="fu">filter</span>(conf_int_95 <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb450-86"><a href="article-figures.html#cb450-86" tabindex="-1"></a></span>
<span id="cb450-87"><a href="article-figures.html#cb450-87" tabindex="-1"></a></span>
<span id="cb450-88"><a href="article-figures.html#cb450-88" tabindex="-1"></a>full_model_tidy <span class="sc">|&gt;</span></span>
<span id="cb450-89"><a href="article-figures.html#cb450-89" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb450-90"><a href="article-figures.html#cb450-90" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb450-91"><a href="article-figures.html#cb450-91" tabindex="-1"></a>        <span class="at">y =</span> OR)</span>
<span id="cb450-92"><a href="article-figures.html#cb450-92" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb450-93"><a href="article-figures.html#cb450-93" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb450-94"><a href="article-figures.html#cb450-94" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(</span>
<span id="cb450-95"><a href="article-figures.html#cb450-95" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb450-96"><a href="article-figures.html#cb450-96" tabindex="-1"></a>      <span class="at">ymin =</span> conf_int_5, </span>
<span id="cb450-97"><a href="article-figures.html#cb450-97" tabindex="-1"></a>      <span class="at">ymax =</span> conf_int_95</span>
<span id="cb450-98"><a href="article-figures.html#cb450-98" tabindex="-1"></a>      )</span>
<span id="cb450-99"><a href="article-figures.html#cb450-99" tabindex="-1"></a>    )  <span class="sc">+</span></span>
<span id="cb450-100"><a href="article-figures.html#cb450-100" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> signi_full_pos, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb450-101"><a href="article-figures.html#cb450-101" tabindex="-1"></a>                <span class="at">y =</span> OR), <span class="at">colour =</span> <span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb450-102"><a href="article-figures.html#cb450-102" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb450-103"><a href="article-figures.html#cb450-103" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> signi_full_neg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb450-104"><a href="article-figures.html#cb450-104" tabindex="-1"></a>                <span class="at">y =</span> OR), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb450-105"><a href="article-figures.html#cb450-105" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb450-106"><a href="article-figures.html#cb450-106" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variable&quot;</span>) <span class="sc">+</span></span>
<span id="cb450-107"><a href="article-figures.html#cb450-107" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;OR&quot;</span>) <span class="sc">+</span></span>
<span id="cb450-108"><a href="article-figures.html#cb450-108" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Multivariate&quot;</span>) <span class="sc">+</span></span>
<span id="cb450-109"><a href="article-figures.html#cb450-109" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">colour  =</span> <span class="st">&#39;darkred&#39;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb450-110"><a href="article-figures.html#cb450-110" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="ot">-&gt;</span> plot3_multivariate</span>
<span id="cb450-111"><a href="article-figures.html#cb450-111" tabindex="-1"></a></span>
<span id="cb450-112"><a href="article-figures.html#cb450-112" tabindex="-1"></a>plot3_multivariate</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="backward-model" class="section level2 hasAnchor" number="5.13">
<h2><span class="header-section-number">5.13</span> Backward model<a href="article-figures.html#backward-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="article-figures.html#cb451-1" tabindex="-1"></a><span class="do">## Backward model</span></span>
<span id="cb451-2"><a href="article-figures.html#cb451-2" tabindex="-1"></a></span>
<span id="cb451-3"><a href="article-figures.html#cb451-3" tabindex="-1"></a>backward_model <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full_model, <span class="at">direction =</span> <span class="st">&quot;backward&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=348.3
## is_painint_chronic ~ sex + age + pain_intensity + duration + 
##     pidbr + headache + disability + posture_work + physical_activity + 
##     smoking + alcohol + bmi + sleep_quality + catastrophizing + 
##     duration_beliefs + concerns + treatment_beliefs + depression + 
##     kinesiophobia + distress + coping + identity_beliefs + hypervigilance + 
##     self_efficacy + relation
## 
##                     Df Deviance    AIC
## - kinesiophobia      1   292.34 346.34
## - depression         1   292.37 346.37
## - disability         1   292.47 346.47
## - hypervigilance     1   292.51 346.51
## - physical_activity  1   292.53 346.53
## - relation           1   292.54 346.54
## - bmi                1   292.60 346.60
## - age                1   292.74 346.73
## - alcohol            1   292.96 346.96
## - duration           1   293.38 347.38
## - coping             1   293.50 347.50
## - sleep_quality      1   293.68 347.68
## - catastrophizing    1   293.76 347.76
## - smoking            1   294.03 348.03
## &lt;none&gt;                   292.30 348.30
## - sex                1   295.09 349.09
## - self_efficacy      1   295.18 349.18
## - distress           1   296.31 350.31
## - pidbr              1   296.80 350.80
## - identity_beliefs   1   297.05 351.05
## - treatment_beliefs  1   297.10 351.10
## - concerns           1   297.26 351.26
## - pain_intensity     1   297.61 351.61
## - headache           2   301.00 353.00
## - posture_work       2   305.61 357.61
## - duration_beliefs   1   306.05 360.05
## 
## Step:  AIC=346.34
## is_painint_chronic ~ sex + age + pain_intensity + duration + 
##     pidbr + headache + disability + posture_work + physical_activity + 
##     smoking + alcohol + bmi + sleep_quality + catastrophizing + 
##     duration_beliefs + concerns + treatment_beliefs + depression + 
##     distress + coping + identity_beliefs + hypervigilance + self_efficacy + 
##     relation
## 
##                     Df Deviance    AIC
## - depression         1   292.40 344.40
## - disability         1   292.49 344.49
## - hypervigilance     1   292.52 344.52
## - physical_activity  1   292.56 344.56
## - relation           1   292.57 344.57
## - bmi                1   292.64 344.64
## - age                1   292.75 344.75
## - alcohol            1   293.00 345.00
## - duration           1   293.40 345.40
## - coping             1   293.51 345.51
## - sleep_quality      1   293.74 345.74
## - catastrophizing    1   293.99 345.99
## - smoking            1   294.15 346.15
## &lt;none&gt;                   292.34 346.34
## - sex                1   295.19 347.19
## - self_efficacy      1   295.42 347.42
## - distress           1   296.34 348.34
## - pidbr              1   296.98 348.98
## - identity_beliefs   1   297.06 349.06
## - treatment_beliefs  1   297.19 349.19
## - concerns           1   297.27 349.27
## - pain_intensity     1   297.81 349.81
## - headache           2   301.18 351.18
## - posture_work       2   305.65 355.65
## - duration_beliefs   1   306.05 358.05
## 
## Step:  AIC=344.4
## is_painint_chronic ~ sex + age + pain_intensity + duration + 
##     pidbr + headache + disability + posture_work + physical_activity + 
##     smoking + alcohol + bmi + sleep_quality + catastrophizing + 
##     duration_beliefs + concerns + treatment_beliefs + distress + 
##     coping + identity_beliefs + hypervigilance + self_efficacy + 
##     relation
## 
##                     Df Deviance    AIC
## - disability         1   292.54 342.54
## - hypervigilance     1   292.58 342.58
## - physical_activity  1   292.61 342.61
## - relation           1   292.66 342.66
## - bmi                1   292.71 342.71
## - age                1   292.81 342.81
## - alcohol            1   293.07 343.07
## - duration           1   293.50 343.50
## - coping             1   293.53 343.53
## - sleep_quality      1   293.79 343.78
## - catastrophizing    1   294.01 344.01
## - smoking            1   294.28 344.28
## &lt;none&gt;                   292.40 344.40
## - sex                1   295.19 345.19
## - self_efficacy      1   295.48 345.48
## - identity_beliefs   1   297.06 347.06
## - pidbr              1   297.10 347.09
## - treatment_beliefs  1   297.20 347.21
## - concerns           1   297.28 347.28
## - pain_intensity     1   297.81 347.81
## - headache           2   301.45 349.45
## - distress           1   300.69 350.69
## - posture_work       2   305.95 353.95
## - duration_beliefs   1   306.15 356.15
## 
## Step:  AIC=342.54
## is_painint_chronic ~ sex + age + pain_intensity + duration + 
##     pidbr + headache + posture_work + physical_activity + smoking + 
##     alcohol + bmi + sleep_quality + catastrophizing + duration_beliefs + 
##     concerns + treatment_beliefs + distress + coping + identity_beliefs + 
##     hypervigilance + self_efficacy + relation
## 
##                     Df Deviance    AIC
## - hypervigilance     1   292.73 340.73
## - physical_activity  1   292.75 340.75
## - relation           1   292.78 340.78
## - bmi                1   292.88 340.88
## - age                1   292.93 340.93
## - alcohol            1   293.24 341.24
## - coping             1   293.67 341.67
## - duration           1   293.67 341.67
## - sleep_quality      1   293.86 341.86
## - catastrophizing    1   294.06 342.06
## - smoking            1   294.35 342.35
## &lt;none&gt;                   292.54 342.54
## - sex                1   295.26 343.26
## - self_efficacy      1   295.51 343.51
## - identity_beliefs   1   297.15 345.15
## - pidbr              1   297.18 345.18
## - treatment_beliefs  1   297.43 345.43
## - concerns           1   297.56 345.56
## - pain_intensity     1   299.29 347.29
## - headache           2   301.68 347.68
## - distress           1   301.42 349.42
## - posture_work       2   305.95 351.95
## - duration_beliefs   1   306.38 354.38
## 
## Step:  AIC=340.73
## is_painint_chronic ~ sex + age + pain_intensity + duration + 
##     pidbr + headache + posture_work + physical_activity + smoking + 
##     alcohol + bmi + sleep_quality + catastrophizing + duration_beliefs + 
##     concerns + treatment_beliefs + distress + coping + identity_beliefs + 
##     self_efficacy + relation
## 
##                     Df Deviance    AIC
## - physical_activity  1   292.96 338.96
## - relation           1   292.96 338.97
## - bmi                1   293.10 339.09
## - age                1   293.17 339.17
## - alcohol            1   293.42 339.42
## - coping             1   293.80 339.80
## - duration           1   293.85 339.85
## - catastrophizing    1   294.06 340.06
## - sleep_quality      1   294.12 340.12
## - smoking            1   294.53 340.53
## &lt;none&gt;                   292.73 340.73
## - sex                1   295.31 341.31
## - self_efficacy      1   295.77 341.77
## - identity_beliefs   1   297.19 343.18
## - pidbr              1   297.21 343.21
## - treatment_beliefs  1   297.56 343.56
## - concerns           1   297.63 343.63
## - pain_intensity     1   299.41 345.41
## - headache           2   301.85 345.85
## - distress           1   303.14 349.14
## - posture_work       2   306.07 350.07
## - duration_beliefs   1   306.49 352.49
## 
## Step:  AIC=338.96
## is_painint_chronic ~ sex + age + pain_intensity + duration + 
##     pidbr + headache + posture_work + smoking + alcohol + bmi + 
##     sleep_quality + catastrophizing + duration_beliefs + concerns + 
##     treatment_beliefs + distress + coping + identity_beliefs + 
##     self_efficacy + relation
## 
##                     Df Deviance    AIC
## - relation           1   293.23 337.23
## - bmi                1   293.36 337.36
## - age                1   293.38 337.38
## - alcohol            1   293.75 337.76
## - coping             1   293.94 337.94
## - duration           1   294.06 338.06
## - catastrophizing    1   294.30 338.30
## - sleep_quality      1   294.33 338.33
## - smoking            1   294.80 338.80
## &lt;none&gt;                   292.96 338.96
## - sex                1   295.60 339.60
## - self_efficacy      1   296.15 340.15
## - identity_beliefs   1   297.51 341.51
## - treatment_beliefs  1   297.74 341.74
## - concerns           1   297.78 341.78
## - pidbr              1   297.88 341.88
## - pain_intensity     1   299.89 343.89
## - headache           2   302.03 344.03
## - distress           1   303.26 347.26
## - posture_work       2   306.13 348.13
## - duration_beliefs   1   306.68 350.68
## 
## Step:  AIC=337.23
## is_painint_chronic ~ sex + age + pain_intensity + duration + 
##     pidbr + headache + posture_work + smoking + alcohol + bmi + 
##     sleep_quality + catastrophizing + duration_beliefs + concerns + 
##     treatment_beliefs + distress + coping + identity_beliefs + 
##     self_efficacy
## 
##                     Df Deviance    AIC
## - bmi                1   293.60 335.60
## - age                1   293.65 335.65
## - alcohol            1   293.96 335.96
## - coping             1   294.21 336.21
## - duration           1   294.25 336.25
## - sleep_quality      1   294.52 336.52
## - catastrophizing    1   294.52 336.52
## - smoking            1   295.12 337.12
## &lt;none&gt;                   293.23 337.23
## - sex                1   295.83 337.83
## - self_efficacy      1   296.25 338.25
## - concerns           1   297.89 339.90
## - pidbr              1   298.00 340.00
## - identity_beliefs   1   298.43 340.43
## - pain_intensity     1   300.03 342.03
## - headache           2   302.17 342.17
## - treatment_beliefs  1   301.51 343.51
## - distress           1   303.46 345.46
## - posture_work       2   306.53 346.53
## - duration_beliefs   1   306.99 348.99
## 
## Step:  AIC=335.6
## is_painint_chronic ~ sex + age + pain_intensity + duration + 
##     pidbr + headache + posture_work + smoking + alcohol + sleep_quality + 
##     catastrophizing + duration_beliefs + concerns + treatment_beliefs + 
##     distress + coping + identity_beliefs + self_efficacy
## 
##                     Df Deviance    AIC
## - age                1   294.09 334.09
## - alcohol            1   294.33 334.34
## - coping             1   294.55 334.55
## - duration           1   294.66 334.66
## - catastrophizing    1   294.86 334.86
## - sleep_quality      1   294.97 334.97
## - smoking            1   295.54 335.54
## &lt;none&gt;                   293.60 335.60
## - sex                1   296.15 336.16
## - self_efficacy      1   296.63 336.63
## - concerns           1   298.31 338.31
## - pidbr              1   298.66 338.66
## - identity_beliefs   1   298.88 338.88
## - headache           2   302.37 340.37
## - pain_intensity     1   300.71 340.71
## - treatment_beliefs  1   301.99 341.99
## - distress           1   303.78 343.78
## - posture_work       2   306.88 344.88
## - duration_beliefs   1   307.00 347.01
## 
## Step:  AIC=334.09
## is_painint_chronic ~ sex + pain_intensity + duration + pidbr + 
##     headache + posture_work + smoking + alcohol + sleep_quality + 
##     catastrophizing + duration_beliefs + concerns + treatment_beliefs + 
##     distress + coping + identity_beliefs + self_efficacy
## 
##                     Df Deviance    AIC
## - alcohol            1   294.82 332.82
## - coping             1   295.12 333.12
## - duration           1   295.13 333.13
## - catastrophizing    1   295.51 333.51
## - sleep_quality      1   295.51 333.51
## &lt;none&gt;                   294.09 334.09
## - smoking            1   296.12 334.12
## - sex                1   296.42 334.42
## - self_efficacy      1   296.92 334.92
## - pidbr              1   299.05 337.05
## - concerns           1   299.46 337.46
## - identity_beliefs   1   299.54 337.54
## - headache           2   302.61 338.61
## - pain_intensity     1   301.78 339.78
## - treatment_beliefs  1   302.81 340.81
## - distress           1   303.85 341.85
## - duration_beliefs   1   307.11 345.11
## - posture_work       2   310.69 346.69
## 
## Step:  AIC=332.82
## is_painint_chronic ~ sex + pain_intensity + duration + pidbr + 
##     headache + posture_work + smoking + sleep_quality + catastrophizing + 
##     duration_beliefs + concerns + treatment_beliefs + distress + 
##     coping + identity_beliefs + self_efficacy
## 
##                     Df Deviance    AIC
## - coping             1   295.75 331.75
## - duration           1   295.99 331.99
## - catastrophizing    1   296.22 332.22
## - sleep_quality      1   296.36 332.36
## &lt;none&gt;                   294.82 332.82
## - smoking            1   296.85 332.85
## - self_efficacy      1   297.49 333.48
## - sex                1   297.93 333.93
## - identity_beliefs   1   299.81 335.81
## - concerns           1   300.02 336.02
## - pidbr              1   300.10 336.09
## - headache           2   303.53 337.53
## - pain_intensity     1   302.07 338.07
## - treatment_beliefs  1   303.57 339.57
## - distress           1   304.64 340.64
## - duration_beliefs   1   307.56 343.55
## - posture_work       2   311.81 345.81
## 
## Step:  AIC=331.75
## is_painint_chronic ~ sex + pain_intensity + duration + pidbr + 
##     headache + posture_work + smoking + sleep_quality + catastrophizing + 
##     duration_beliefs + concerns + treatment_beliefs + distress + 
##     identity_beliefs + self_efficacy
## 
##                     Df Deviance    AIC
## - duration           1   296.97 330.97
## - sleep_quality      1   297.34 331.34
## - catastrophizing    1   297.51 331.51
## - smoking            1   297.73 331.73
## &lt;none&gt;                   295.75 331.75
## - self_efficacy      1   298.75 332.76
## - sex                1   299.15 333.15
## - concerns           1   300.95 334.95
## - identity_beliefs   1   300.97 334.97
## - pidbr              1   300.98 334.98
## - headache           2   304.17 336.17
## - pain_intensity     1   303.17 337.17
## - treatment_beliefs  1   304.69 338.69
## - distress           1   305.05 339.05
## - duration_beliefs   1   308.49 342.48
## - posture_work       2   312.99 344.99
## 
## Step:  AIC=330.97
## is_painint_chronic ~ sex + pain_intensity + pidbr + headache + 
##     posture_work + smoking + sleep_quality + catastrophizing + 
##     duration_beliefs + concerns + treatment_beliefs + distress + 
##     identity_beliefs + self_efficacy
## 
##                     Df Deviance    AIC
## - sleep_quality      1   298.33 330.33
## - smoking            1   298.74 330.74
## &lt;none&gt;                   296.97 330.97
## - catastrophizing    1   299.09 331.09
## - self_efficacy      1   300.04 332.04
## - sex                1   300.20 332.20
## - pidbr              1   302.16 334.16
## - concerns           1   302.18 334.18
## - identity_beliefs   1   302.57 334.57
## - headache           2   306.05 336.05
## - pain_intensity     1   304.55 336.55
## - treatment_beliefs  1   305.75 337.75
## - distress           1   306.38 338.38
## - duration_beliefs   1   310.88 342.88
## - posture_work       2   314.79 344.79
## 
## Step:  AIC=330.33
## is_painint_chronic ~ sex + pain_intensity + pidbr + headache + 
##     posture_work + smoking + catastrophizing + duration_beliefs + 
##     concerns + treatment_beliefs + distress + identity_beliefs + 
##     self_efficacy
## 
##                     Df Deviance    AIC
## - smoking            1   300.31 330.31
## &lt;none&gt;                   298.33 330.33
## - catastrophizing    1   300.38 330.38
## - sex                1   300.92 330.92
## - self_efficacy      1   301.21 331.21
## - pidbr              1   303.45 333.45
## - concerns           1   303.46 333.46
## - identity_beliefs   1   303.75 333.75
## - headache           2   307.06 335.06
## - pain_intensity     1   306.00 336.00
## - distress           1   306.87 336.87
## - treatment_beliefs  1   307.03 337.03
## - duration_beliefs   1   311.49 341.49
## - posture_work       2   315.31 343.32
## 
## Step:  AIC=330.31
## is_painint_chronic ~ sex + pain_intensity + pidbr + headache + 
##     posture_work + catastrophizing + duration_beliefs + concerns + 
##     treatment_beliefs + distress + identity_beliefs + self_efficacy
## 
##                     Df Deviance    AIC
## - catastrophizing    1   302.15 330.15
## &lt;none&gt;                   300.31 330.31
## - self_efficacy      1   302.93 330.93
## - sex                1   303.19 331.19
## - concerns           1   305.14 333.14
## - pidbr              1   305.82 333.82
## - identity_beliefs   1   306.00 334.00
## - headache           2   308.56 334.56
## - pain_intensity     1   308.70 336.70
## - treatment_beliefs  1   308.71 336.71
## - distress           1   309.30 337.30
## - duration_beliefs   1   313.20 341.20
## - posture_work       2   317.19 343.19
## 
## Step:  AIC=330.15
## is_painint_chronic ~ sex + pain_intensity + pidbr + headache + 
##     posture_work + duration_beliefs + concerns + treatment_beliefs + 
##     distress + identity_beliefs + self_efficacy
## 
##                     Df Deviance    AIC
## &lt;none&gt;                   302.15 330.15
## - sex                1   304.88 330.88
## - concerns           1   305.40 331.40
## - self_efficacy      1   305.41 331.41
## - identity_beliefs   1   308.10 334.10
## - pidbr              1   308.22 334.22
## - headache           2   310.34 334.34
## - distress           1   309.57 335.57
## - pain_intensity     1   309.94 335.94
## - treatment_beliefs  1   310.91 336.91
## - duration_beliefs   1   315.02 341.02
## - posture_work       2   318.64 342.64</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="article-figures.html#cb453-1" tabindex="-1"></a><span class="fu">summary</span>(backward_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = is_painint_chronic ~ sex + pain_intensity + pidbr + 
##     headache + posture_work + duration_beliefs + concerns + treatment_beliefs + 
##     distress + identity_beliefs + self_efficacy, family = &quot;binomial&quot;, 
##     data = imputed_with_attitude_and_chronic)
## 
## Coefficients:
##                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -6.65374    1.29837  -5.125 2.98e-07 ***
## sex2               0.56597    0.35162   1.610 0.107479    
## pain_intensity     0.27423    0.10267   2.671 0.007565 ** 
## pidbr2             0.88672    0.38035   2.331 0.019736 *  
## headache2          0.87757    0.36108   2.430 0.015083 *  
## headache3         -0.08510    0.58802  -0.145 0.884935    
## posture_work2      0.46378    0.40024   1.159 0.246551    
## posture_work3      1.58390    0.38480   4.116 3.85e-05 ***
## duration_beliefs   0.22295    0.06336   3.519 0.000434 ***
## concerns           0.13027    0.07322   1.779 0.075225 .  
## treatment_beliefs -0.24623    0.08153  -3.020 0.002528 ** 
## distress           0.10033    0.03668   2.735 0.006229 ** 
## identity_beliefs  -0.17109    0.07087  -2.414 0.015765 *  
## self_efficacy      0.13188    0.07682   1.717 0.086033 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 399.47  on 602  degrees of freedom
## Residual deviance: 302.15  on 589  degrees of freedom
## AIC: 330.15
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="article-figures.html#cb455-1" tabindex="-1"></a>odds_ratios_full <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(full_model))</span>
<span id="cb455-2"><a href="article-figures.html#cb455-2" tabindex="-1"></a>conf_int_full <span class="ot">&lt;-</span> <span class="fu">confint</span>(full_model, )</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="article-figures.html#cb457-1" tabindex="-1"></a>conf_int_exp_full <span class="ot">&lt;-</span> <span class="fu">exp</span>(conf_int_full)</span>
<span id="cb457-2"><a href="article-figures.html#cb457-2" tabindex="-1"></a></span>
<span id="cb457-3"><a href="article-figures.html#cb457-3" tabindex="-1"></a>backward_model<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##       (Intercept)              sex2    pain_intensity            pidbr2 
##       -6.65374041        0.56597427        0.27422649        0.88672239 
##         headache2         headache3     posture_work2     posture_work3 
##        0.87757015       -0.08509645        0.46378204        1.58389588 
##  duration_beliefs          concerns treatment_beliefs          distress 
##        0.22295285        0.13027246       -0.24622667        0.10032867 
##  identity_beliefs     self_efficacy 
##       -0.17109476        0.13188227</code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="article-figures.html#cb459-1" tabindex="-1"></a>model_backward_tidy <span class="ot">&lt;-</span> backward_model <span class="sc">|&gt;</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb459-2"><a href="article-figures.html#cb459-2" tabindex="-1"></a></span>
<span id="cb459-3"><a href="article-figures.html#cb459-3" tabindex="-1"></a><span class="do">## look up calcualtion of OR from estimate and other model metrics</span></span>
<span id="cb459-4"><a href="article-figures.html#cb459-4" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(backward_model))</span>
<span id="cb459-5"><a href="article-figures.html#cb459-5" tabindex="-1"></a>conf_int <span class="ot">&lt;-</span> <span class="fu">confint</span>(backward_model, )</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="article-figures.html#cb461-1" tabindex="-1"></a>conf_int_exp <span class="ot">&lt;-</span> <span class="fu">exp</span>(conf_int)</span>
<span id="cb461-2"><a href="article-figures.html#cb461-2" tabindex="-1"></a></span>
<span id="cb461-3"><a href="article-figures.html#cb461-3" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OddsRatio =</span> odds_ratios,</span>
<span id="cb461-4"><a href="article-figures.html#cb461-4" tabindex="-1"></a>                      <span class="at">Lower97_5CI =</span> conf_int_exp[, <span class="st">&quot;2.5 %&quot;</span>],</span>
<span id="cb461-5"><a href="article-figures.html#cb461-5" tabindex="-1"></a>                      <span class="at">Upper97_5CI =</span> conf_int_exp[, <span class="st">&quot;97.5 %&quot;</span>])</span>
<span id="cb461-6"><a href="article-figures.html#cb461-6" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##                     OddsRatio  Lower97_5CI Upper97_5CI
## (Intercept)       0.001289191 8.857723e-05  0.01462702
## sex2              1.761162794 9.028590e-01  3.61370233
## pain_intensity    1.315512715 1.082763e+00  1.62190191
## pidbr2            2.427161319 1.190556e+00  5.35031953
## headache2         2.405048685 1.210661e+00  5.02912669
## headache3         0.918423699 2.659645e-01  2.77353119
## posture_work2     1.590076355 7.059536e-01  3.42898788
## posture_work3     4.873907046 2.290224e+00 10.43194469
## duration_beliefs  1.249761645 1.105659e+00  1.41867676
## concerns          1.139138706 9.889557e-01  1.31893284
## treatment_beliefs 0.781745003 6.659186e-01  0.91872682
## distress          1.105534217 1.028728e+00  1.18846015
## identity_beliefs  0.842741709 7.316495e-01  0.96705986
## self_efficacy     1.140973980 9.893504e-01  1.33839592</code></pre>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="article-figures.html#cb463-1" tabindex="-1"></a><span class="do">## tidy backward model</span></span>
<span id="cb463-2"><a href="article-figures.html#cb463-2" tabindex="-1"></a>z_score <span class="ot">=</span> <span class="fl">1.96</span></span>
<span id="cb463-3"><a href="article-figures.html#cb463-3" tabindex="-1"></a>model_backward_tidy <span class="ot">&lt;-</span> model_backward_tidy <span class="sc">|&gt;</span></span>
<span id="cb463-4"><a href="article-figures.html#cb463-4" tabindex="-1"></a>   <span class="fu">mutate</span>(</span>
<span id="cb463-5"><a href="article-figures.html#cb463-5" tabindex="-1"></a>      <span class="at">conf_int_lower =</span> <span class="fu">exp</span>(estimate <span class="sc">-</span> z_score <span class="sc">*</span> std.error),</span>
<span id="cb463-6"><a href="article-figures.html#cb463-6" tabindex="-1"></a>      <span class="at">OR =</span> <span class="fu">exp</span>(estimate),</span>
<span id="cb463-7"><a href="article-figures.html#cb463-7" tabindex="-1"></a>      <span class="at">conf_int_upper =</span> <span class="fu">exp</span>(</span>
<span id="cb463-8"><a href="article-figures.html#cb463-8" tabindex="-1"></a>        estimate <span class="sc">+</span> z_score <span class="sc">*</span> std.error))</span>
<span id="cb463-9"><a href="article-figures.html#cb463-9" tabindex="-1"></a></span>
<span id="cb463-10"><a href="article-figures.html#cb463-10" tabindex="-1"></a>model_backward_tidy <span class="ot">&lt;-</span> model_backward_tidy[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb463-11"><a href="article-figures.html#cb463-11" tabindex="-1"></a></span>
<span id="cb463-12"><a href="article-figures.html#cb463-12" tabindex="-1"></a>model_backward_tidy <span class="ot">&lt;-</span> model_backward_tidy <span class="sc">|&gt;</span></span>
<span id="cb463-13"><a href="article-figures.html#cb463-13" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb463-14"><a href="article-figures.html#cb463-14" tabindex="-1"></a>    <span class="at">conf_int_5 =</span> conf_int_lower,</span>
<span id="cb463-15"><a href="article-figures.html#cb463-15" tabindex="-1"></a>    <span class="at">conf_int_95 =</span> conf_int_upper</span>
<span id="cb463-16"><a href="article-figures.html#cb463-16" tabindex="-1"></a>  )</span>
<span id="cb463-17"><a href="article-figures.html#cb463-17" tabindex="-1"></a></span>
<span id="cb463-18"><a href="article-figures.html#cb463-18" tabindex="-1"></a> model_backward_tidy <span class="ot">&lt;-</span> model_backward_tidy <span class="sc">%&gt;%</span></span>
<span id="cb463-19"><a href="article-figures.html#cb463-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">significance =</span> <span class="fu">case_when</span>(</span>
<span id="cb463-20"><a href="article-figures.html#cb463-20" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">&quot;***&quot;</span>,</span>
<span id="cb463-21"><a href="article-figures.html#cb463-21" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;**&quot;</span>,</span>
<span id="cb463-22"><a href="article-figures.html#cb463-22" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;*&quot;</span>,</span>
<span id="cb463-23"><a href="article-figures.html#cb463-23" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;&quot;</span> <span class="co"># No asterisk if p-value is not significant</span></span>
<span id="cb463-24"><a href="article-figures.html#cb463-24" tabindex="-1"></a>  ))</span></code></pre></div>
</div>
<div id="visualize-backward-model" class="section level2 hasAnchor" number="5.14">
<h2><span class="header-section-number">5.14</span> Visualize backward model<a href="article-figures.html#visualize-backward-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="article-figures.html#cb464-1" tabindex="-1"></a>signi_backward_pos <span class="ot">&lt;-</span> model_backward_tidy <span class="sc">|&gt;</span></span>
<span id="cb464-2"><a href="article-figures.html#cb464-2" tabindex="-1"></a>  <span class="fu">filter</span>(conf_int_5 <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb464-3"><a href="article-figures.html#cb464-3" tabindex="-1"></a></span>
<span id="cb464-4"><a href="article-figures.html#cb464-4" tabindex="-1"></a>signi_backward_neg <span class="ot">&lt;-</span> model_backward_tidy <span class="sc">|&gt;</span></span>
<span id="cb464-5"><a href="article-figures.html#cb464-5" tabindex="-1"></a>  <span class="fu">filter</span>(conf_int_95 <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb464-6"><a href="article-figures.html#cb464-6" tabindex="-1"></a></span>
<span id="cb464-7"><a href="article-figures.html#cb464-7" tabindex="-1"></a>model_backward_tidy <span class="sc">|&gt;</span></span>
<span id="cb464-8"><a href="article-figures.html#cb464-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb464-9"><a href="article-figures.html#cb464-9" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb464-10"><a href="article-figures.html#cb464-10" tabindex="-1"></a>        <span class="at">y =</span> OR)</span>
<span id="cb464-11"><a href="article-figures.html#cb464-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb464-12"><a href="article-figures.html#cb464-12" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb464-13"><a href="article-figures.html#cb464-13" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(</span>
<span id="cb464-14"><a href="article-figures.html#cb464-14" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb464-15"><a href="article-figures.html#cb464-15" tabindex="-1"></a>      <span class="at">ymin =</span> conf_int_5, </span>
<span id="cb464-16"><a href="article-figures.html#cb464-16" tabindex="-1"></a>      <span class="at">ymax =</span> conf_int_95</span>
<span id="cb464-17"><a href="article-figures.html#cb464-17" tabindex="-1"></a>      )</span>
<span id="cb464-18"><a href="article-figures.html#cb464-18" tabindex="-1"></a>    )  <span class="sc">+</span></span>
<span id="cb464-19"><a href="article-figures.html#cb464-19" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> signi_backward_pos, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb464-20"><a href="article-figures.html#cb464-20" tabindex="-1"></a>                <span class="at">y =</span> OR), <span class="at">colour =</span> <span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb464-21"><a href="article-figures.html#cb464-21" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb464-22"><a href="article-figures.html#cb464-22" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> signi_backward_neg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(term), OR),</span>
<span id="cb464-23"><a href="article-figures.html#cb464-23" tabindex="-1"></a>                <span class="at">y =</span> OR), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb464-24"><a href="article-figures.html#cb464-24" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb464-25"><a href="article-figures.html#cb464-25" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variable&quot;</span>) <span class="sc">+</span></span>
<span id="cb464-26"><a href="article-figures.html#cb464-26" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;OR&quot;</span>) <span class="sc">+</span></span>
<span id="cb464-27"><a href="article-figures.html#cb464-27" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Backward&quot;</span>) <span class="sc">+</span></span>
<span id="cb464-28"><a href="article-figures.html#cb464-28" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">colour  =</span> <span class="st">&#39;darkred&#39;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb464-29"><a href="article-figures.html#cb464-29" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="ot">-&gt;</span> plot4_backward</span>
<span id="cb464-30"><a href="article-figures.html#cb464-30" tabindex="-1"></a></span>
<span id="cb464-31"><a href="article-figures.html#cb464-31" tabindex="-1"></a>plot4_backward</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="panel-plot-with-all-models" class="section level2 hasAnchor" number="5.15">
<h2><span class="header-section-number">5.15</span> Panel plot with all models<a href="article-figures.html#panel-plot-with-all-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="article-figures.html#cb465-1" tabindex="-1"></a>panel_all_high_res <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb465-2"><a href="article-figures.html#cb465-2" tabindex="-1"></a>  plot1_univariate_continuous <span class="sc">+</span> citrulliner<span class="sc">::</span><span class="fu">theme_individual</span>(),</span>
<span id="cb465-3"><a href="article-figures.html#cb465-3" tabindex="-1"></a>  plot2_univariate_categorical <span class="sc">+</span> citrulliner<span class="sc">::</span><span class="fu">theme_individual</span>(),</span>
<span id="cb465-4"><a href="article-figures.html#cb465-4" tabindex="-1"></a>  plot4_backward <span class="sc">+</span> citrulliner<span class="sc">::</span><span class="fu">theme_individual</span>(),</span>
<span id="cb465-5"><a href="article-figures.html#cb465-5" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>), <span class="at">label_size =</span> <span class="dv">30</span>,</span>
<span id="cb465-6"><a href="article-figures.html#cb465-6" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span></span>
<span id="cb465-7"><a href="article-figures.html#cb465-7" tabindex="-1"></a>)</span>
<span id="cb465-8"><a href="article-figures.html#cb465-8" tabindex="-1"></a></span>
<span id="cb465-9"><a href="article-figures.html#cb465-9" tabindex="-1"></a>panel_all <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb465-10"><a href="article-figures.html#cb465-10" tabindex="-1"></a>  plot1_univariate_continuous,</span>
<span id="cb465-11"><a href="article-figures.html#cb465-11" tabindex="-1"></a>  plot2_univariate_categorical,</span>
<span id="cb465-12"><a href="article-figures.html#cb465-12" tabindex="-1"></a>  plot4_backward,</span>
<span id="cb465-13"><a href="article-figures.html#cb465-13" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>),</span>
<span id="cb465-14"><a href="article-figures.html#cb465-14" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">1</span></span>
<span id="cb465-15"><a href="article-figures.html#cb465-15" tabindex="-1"></a>)</span>
<span id="cb465-16"><a href="article-figures.html#cb465-16" tabindex="-1"></a>panel_all</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="article-figures.html#cb466-1" tabindex="-1"></a><span class="co">#remotes::install_github(</span></span>
<span id="cb466-2"><a href="article-figures.html#cb466-2" tabindex="-1"></a><span class="co">#  &quot;uashogeschoolutrecht/citrulliner&quot;</span></span>
<span id="cb466-3"><a href="article-figures.html#cb466-3" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb466-4"><a href="article-figures.html#cb466-4" tabindex="-1"></a><span class="fu">library</span>(citrulliner)</span>
<span id="cb466-5"><a href="article-figures.html#cb466-5" tabindex="-1"></a></span>
<span id="cb466-6"><a href="article-figures.html#cb466-6" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb466-7"><a href="article-figures.html#cb466-7" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb466-8"><a href="article-figures.html#cb466-8" tabindex="-1"></a>    <span class="st">&quot;img&quot;</span>,</span>
<span id="cb466-9"><a href="article-figures.html#cb466-9" tabindex="-1"></a>    <span class="st">&quot;all_models.svg&quot;</span>),</span>
<span id="cb466-10"><a href="article-figures.html#cb466-10" tabindex="-1"></a>  panel_all_high_res,</span>
<span id="cb466-11"><a href="article-figures.html#cb466-11" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">30</span>,</span>
<span id="cb466-12"><a href="article-figures.html#cb466-12" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">70</span>,</span>
<span id="cb466-13"><a href="article-figures.html#cb466-13" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb466-14"><a href="article-figures.html#cb466-14" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
</div>
<div id="rework-figure-labels" class="section level2 hasAnchor" number="5.16">
<h2><span class="header-section-number">5.16</span> Rework figure labels<a href="article-figures.html#rework-figure-labels" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="article-figures.html#cb467-1" tabindex="-1"></a>df_univariate_continuous <span class="ot">&lt;-</span> df_univariate_continuous <span class="sc">|&gt;</span></span>
<span id="cb467-2"><a href="article-figures.html#cb467-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb467-3"><a href="article-figures.html#cb467-3" tabindex="-1"></a>    <span class="at">fig =</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb467-4"><a href="article-figures.html#cb467-4" tabindex="-1"></a>  )</span>
<span id="cb467-5"><a href="article-figures.html#cb467-5" tabindex="-1"></a>df_univariate_categorical <span class="ot">&lt;-</span> df_univariate_categorical <span class="sc">|&gt;</span></span>
<span id="cb467-6"><a href="article-figures.html#cb467-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb467-7"><a href="article-figures.html#cb467-7" tabindex="-1"></a>    <span class="at">fig =</span> <span class="st">&quot;B&quot;</span></span>
<span id="cb467-8"><a href="article-figures.html#cb467-8" tabindex="-1"></a>  )</span>
<span id="cb467-9"><a href="article-figures.html#cb467-9" tabindex="-1"></a>model_backward_tidy <span class="ot">&lt;-</span> model_backward_tidy <span class="sc">|&gt;</span></span>
<span id="cb467-10"><a href="article-figures.html#cb467-10" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb467-11"><a href="article-figures.html#cb467-11" tabindex="-1"></a>    <span class="at">fig =</span> <span class="st">&quot;C&quot;</span></span>
<span id="cb467-12"><a href="article-figures.html#cb467-12" tabindex="-1"></a>  )</span>
<span id="cb467-13"><a href="article-figures.html#cb467-13" tabindex="-1"></a></span>
<span id="cb467-14"><a href="article-figures.html#cb467-14" tabindex="-1"></a>results <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb467-15"><a href="article-figures.html#cb467-15" tabindex="-1"></a>  df_univariate_continuous,</span>
<span id="cb467-16"><a href="article-figures.html#cb467-16" tabindex="-1"></a>  df_univariate_categorical,</span>
<span id="cb467-17"><a href="article-figures.html#cb467-17" tabindex="-1"></a>  model_backward_tidy</span>
<span id="cb467-18"><a href="article-figures.html#cb467-18" tabindex="-1"></a>)</span>
<span id="cb467-19"><a href="article-figures.html#cb467-19" tabindex="-1"></a></span>
<span id="cb467-20"><a href="article-figures.html#cb467-20" tabindex="-1"></a><span class="do">## write to disk and edit by hand to relabel</span></span>
<span id="cb467-21"><a href="article-figures.html#cb467-21" tabindex="-1"></a><span class="co">#readr::write_csv(</span></span>
<span id="cb467-22"><a href="article-figures.html#cb467-22" tabindex="-1"></a><span class="co">#  enframe(labels_raw$term),</span></span>
<span id="cb467-23"><a href="article-figures.html#cb467-23" tabindex="-1"></a><span class="co">#  file = here::here(</span></span>
<span id="cb467-24"><a href="article-figures.html#cb467-24" tabindex="-1"></a><span class="co">#    &quot;data-raw&quot;,</span></span>
<span id="cb467-25"><a href="article-figures.html#cb467-25" tabindex="-1"></a><span class="co">#    &quot;labels-relevel.csv&quot;</span></span>
<span id="cb467-26"><a href="article-figures.html#cb467-26" tabindex="-1"></a><span class="co">#  )</span></span>
<span id="cb467-27"><a href="article-figures.html#cb467-27" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb467-28"><a href="article-figures.html#cb467-28" tabindex="-1"></a></span>
<span id="cb467-29"><a href="article-figures.html#cb467-29" tabindex="-1"></a><span class="do">## Read from disk</span></span>
<span id="cb467-30"><a href="article-figures.html#cb467-30" tabindex="-1"></a>labels_relevel <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb467-31"><a href="article-figures.html#cb467-31" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb467-32"><a href="article-figures.html#cb467-32" tabindex="-1"></a>    <span class="st">&quot;data-raw&quot;</span>,</span>
<span id="cb467-33"><a href="article-figures.html#cb467-33" tabindex="-1"></a>    <span class="st">&quot;labels-relevel.csv&quot;</span></span>
<span id="cb467-34"><a href="article-figures.html#cb467-34" tabindex="-1"></a>  )</span>
<span id="cb467-35"><a href="article-figures.html#cb467-35" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning: One or more parsing issues, call `problems()` on your data frame for details,
## e.g.:
##   dat &lt;- vroom(...)
##   problems(dat)</code></pre>
<pre><code>## Rows: 47 Columns: 4
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (3): value, new_name, level
## dbl (1): name
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="article-figures.html#cb470-1" tabindex="-1"></a><span class="do">## join with results</span></span>
<span id="cb470-2"><a href="article-figures.html#cb470-2" tabindex="-1"></a>results<span class="sc">$</span>new_labels <span class="ot">&lt;-</span> labels_relevel<span class="sc">$</span>new_name</span></code></pre></div>
</div>
<div id="figures-for-paper" class="section level2 hasAnchor" number="5.17">
<h2><span class="header-section-number">5.17</span> Figures for paper<a href="article-figures.html#figures-for-paper" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="article-figures.html#cb471-1" tabindex="-1"></a><span class="do">## plotting function</span></span>
<span id="cb471-2"><a href="article-figures.html#cb471-2" tabindex="-1"></a></span>
<span id="cb471-3"><a href="article-figures.html#cb471-3" tabindex="-1"></a>plot_model_results <span class="ot">&lt;-</span> <span class="cf">function</span>(df_model_tidy, title, ...) {</span>
<span id="cb471-4"><a href="article-figures.html#cb471-4" tabindex="-1"></a>  </span>
<span id="cb471-5"><a href="article-figures.html#cb471-5" tabindex="-1"></a>  <span class="do">## significant OR</span></span>
<span id="cb471-6"><a href="article-figures.html#cb471-6" tabindex="-1"></a>  signi_pos <span class="ot">&lt;-</span> df_model_tidy <span class="sc">|&gt;</span></span>
<span id="cb471-7"><a href="article-figures.html#cb471-7" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(conf_int_5 <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb471-8"><a href="article-figures.html#cb471-8" tabindex="-1"></a>  </span>
<span id="cb471-9"><a href="article-figures.html#cb471-9" tabindex="-1"></a>  signi_neg <span class="ot">&lt;-</span> df_model_tidy <span class="sc">|&gt;</span></span>
<span id="cb471-10"><a href="article-figures.html#cb471-10" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(conf_int_95 <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb471-11"><a href="article-figures.html#cb471-11" tabindex="-1"></a>  </span>
<span id="cb471-12"><a href="article-figures.html#cb471-12" tabindex="-1"></a>  <span class="do">## significance (stars for p-value)</span></span>
<span id="cb471-13"><a href="article-figures.html#cb471-13" tabindex="-1"></a>  df_model_tidy <span class="ot">&lt;-</span> df_model_tidy <span class="sc">%&gt;%</span></span>
<span id="cb471-14"><a href="article-figures.html#cb471-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">significance =</span> <span class="fu">case_when</span>(</span>
<span id="cb471-15"><a href="article-figures.html#cb471-15" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">&quot;***&quot;</span>,</span>
<span id="cb471-16"><a href="article-figures.html#cb471-16" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;**&quot;</span>,</span>
<span id="cb471-17"><a href="article-figures.html#cb471-17" tabindex="-1"></a>    p.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;*&quot;</span>,</span>
<span id="cb471-18"><a href="article-figures.html#cb471-18" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;&quot;</span> <span class="co"># No asterisk if p-value is not significant</span></span>
<span id="cb471-19"><a href="article-figures.html#cb471-19" tabindex="-1"></a>  ))</span>
<span id="cb471-20"><a href="article-figures.html#cb471-20" tabindex="-1"></a>  </span>
<span id="cb471-21"><a href="article-figures.html#cb471-21" tabindex="-1"></a>  <span class="do">## plot</span></span>
<span id="cb471-22"><a href="article-figures.html#cb471-22" tabindex="-1"></a>  df_model_tidy <span class="sc">|&gt;</span></span>
<span id="cb471-23"><a href="article-figures.html#cb471-23" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(new_labels), OR),</span>
<span id="cb471-24"><a href="article-figures.html#cb471-24" tabindex="-1"></a>               <span class="at">y =</span> OR)) <span class="sc">+</span></span>
<span id="cb471-25"><a href="article-figures.html#cb471-25" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb471-26"><a href="article-figures.html#cb471-26" tabindex="-1"></a>    <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf_int_5,</span>
<span id="cb471-27"><a href="article-figures.html#cb471-27" tabindex="-1"></a>                        <span class="at">ymax =</span> conf_int_95))  <span class="sc">+</span></span>
<span id="cb471-28"><a href="article-figures.html#cb471-28" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb471-29"><a href="article-figures.html#cb471-29" tabindex="-1"></a>      <span class="at">data =</span> signi_pos,</span>
<span id="cb471-30"><a href="article-figures.html#cb471-30" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(new_labels), OR),</span>
<span id="cb471-31"><a href="article-figures.html#cb471-31" tabindex="-1"></a>          <span class="at">y =</span> OR),</span>
<span id="cb471-32"><a href="article-figures.html#cb471-32" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb471-33"><a href="article-figures.html#cb471-33" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb471-34"><a href="article-figures.html#cb471-34" tabindex="-1"></a>     <span class="co"># shape = 25,</span></span>
<span id="cb471-35"><a href="article-figures.html#cb471-35" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb471-36"><a href="article-figures.html#cb471-36" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb471-37"><a href="article-figures.html#cb471-37" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb471-38"><a href="article-figures.html#cb471-38" tabindex="-1"></a>      <span class="at">data =</span> signi_neg,</span>
<span id="cb471-39"><a href="article-figures.html#cb471-39" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="fu">as_factor</span>(new_labels), OR),</span>
<span id="cb471-40"><a href="article-figures.html#cb471-40" tabindex="-1"></a>          <span class="at">y =</span> OR),</span>
<span id="cb471-41"><a href="article-figures.html#cb471-41" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb471-42"><a href="article-figures.html#cb471-42" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb471-43"><a href="article-figures.html#cb471-43" tabindex="-1"></a>    <span class="co">#  shape = 24,</span></span>
<span id="cb471-44"><a href="article-figures.html#cb471-44" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;green&quot;</span></span>
<span id="cb471-45"><a href="article-figures.html#cb471-45" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb471-46"><a href="article-figures.html#cb471-46" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb471-47"><a href="article-figures.html#cb471-47" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;OR&quot;</span>) <span class="sc">+</span></span>
<span id="cb471-48"><a href="article-figures.html#cb471-48" tabindex="-1"></a>    <span class="fu">ggtitle</span>(title) <span class="sc">+</span></span>
<span id="cb471-49"><a href="article-figures.html#cb471-49" tabindex="-1"></a>    <span class="fu">geom_hline</span>(</span>
<span id="cb471-50"><a href="article-figures.html#cb471-50" tabindex="-1"></a>      <span class="at">yintercept =</span> <span class="dv">1</span>,</span>
<span id="cb471-51"><a href="article-figures.html#cb471-51" tabindex="-1"></a>      <span class="at">colour  =</span> <span class="st">&#39;darkred&#39;</span>,</span>
<span id="cb471-52"><a href="article-figures.html#cb471-52" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span></span>
<span id="cb471-53"><a href="article-figures.html#cb471-53" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb471-54"><a href="article-figures.html#cb471-54" tabindex="-1"></a> <span class="co">#   geom_text(aes(label = paste(significance), y = OR * 1), ..., check_overlap = TRUE, size = 4) +</span></span>
<span id="cb471-55"><a href="article-figures.html#cb471-55" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb471-56"><a href="article-figures.html#cb471-56" tabindex="-1"></a>    painr<span class="sc">::</span><span class="fu">theme_individual</span>() <span class="ot">-&gt;</span> plot</span>
<span id="cb471-57"><a href="article-figures.html#cb471-57" tabindex="-1"></a>  </span>
<span id="cb471-58"><a href="article-figures.html#cb471-58" tabindex="-1"></a>  <span class="fu">return</span>(plot)</span>
<span id="cb471-59"><a href="article-figures.html#cb471-59" tabindex="-1"></a>  </span>
<span id="cb471-60"><a href="article-figures.html#cb471-60" tabindex="-1"></a>}</span>
<span id="cb471-61"><a href="article-figures.html#cb471-61" tabindex="-1"></a></span>
<span id="cb471-62"><a href="article-figures.html#cb471-62" tabindex="-1"></a><span class="do">## nest data to figure</span></span>
<span id="cb471-63"><a href="article-figures.html#cb471-63" tabindex="-1"></a>results_nested <span class="ot">&lt;-</span> results <span class="sc">|&gt;</span></span>
<span id="cb471-64"><a href="article-figures.html#cb471-64" tabindex="-1"></a>  <span class="fu">group_by</span>(fig) <span class="sc">|&gt;</span></span>
<span id="cb471-65"><a href="article-figures.html#cb471-65" tabindex="-1"></a>  <span class="fu">nest</span>()</span>
<span id="cb471-66"><a href="article-figures.html#cb471-66" tabindex="-1"></a></span>
<span id="cb471-67"><a href="article-figures.html#cb471-67" tabindex="-1"></a><span class="fu">plot_model_results</span>(</span>
<span id="cb471-68"><a href="article-figures.html#cb471-68" tabindex="-1"></a>  results_nested<span class="sc">$</span>data[[<span class="dv">3</span>]],</span>
<span id="cb471-69"><a href="article-figures.html#cb471-69" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;test&quot;</span></span>
<span id="cb471-70"><a href="article-figures.html#cb471-70" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="article-figures.html#cb472-1" tabindex="-1"></a>results_nested<span class="sc">$</span>titles <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb472-2"><a href="article-figures.html#cb472-2" tabindex="-1"></a>  <span class="st">&quot;Univariate continuous&quot;</span>,</span>
<span id="cb472-3"><a href="article-figures.html#cb472-3" tabindex="-1"></a>  <span class="st">&quot;Univeriate categorical&quot;</span>,</span>
<span id="cb472-4"><a href="article-figures.html#cb472-4" tabindex="-1"></a>  <span class="st">&quot;Multivariate backward&quot;</span>)</span>
<span id="cb472-5"><a href="article-figures.html#cb472-5" tabindex="-1"></a></span>
<span id="cb472-6"><a href="article-figures.html#cb472-6" tabindex="-1"></a><span class="do">## add figures</span></span>
<span id="cb472-7"><a href="article-figures.html#cb472-7" tabindex="-1"></a>plot_A <span class="ot">&lt;-</span> <span class="fu">plot_model_results</span>(</span>
<span id="cb472-8"><a href="article-figures.html#cb472-8" tabindex="-1"></a>  <span class="at">df_model_tidy =</span> results_nested<span class="sc">$</span>data[[<span class="dv">1</span>]],</span>
<span id="cb472-9"><a href="article-figures.html#cb472-9" tabindex="-1"></a>  <span class="at">title =</span> results_nested<span class="sc">$</span>titles[[<span class="dv">1</span>]],</span>
<span id="cb472-10"><a href="article-figures.html#cb472-10" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb472-11"><a href="article-figures.html#cb472-11" tabindex="-1"></a>  <span class="at">vjust =</span> <span class="fl">0.05</span></span>
<span id="cb472-12"><a href="article-figures.html#cb472-12" tabindex="-1"></a>)</span>
<span id="cb472-13"><a href="article-figures.html#cb472-13" tabindex="-1"></a>plot_A <span class="ot">&lt;-</span> plot_A <span class="sc">+</span> painr<span class="sc">::</span><span class="fu">theme_individual</span>()</span>
<span id="cb472-14"><a href="article-figures.html#cb472-14" tabindex="-1"></a>plot_A</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-17-2.png" width="672" /></p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="article-figures.html#cb473-1" tabindex="-1"></a><span class="do">## add figures</span></span>
<span id="cb473-2"><a href="article-figures.html#cb473-2" tabindex="-1"></a>data_B <span class="ot">&lt;-</span> results_nested<span class="sc">$</span>data[[<span class="dv">2</span>]] <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">&quot;work_satisfaction3&quot;</span>, term <span class="sc">!=</span> <span class="st">&quot;work_happiness3&quot;</span>)</span>
<span id="cb473-3"><a href="article-figures.html#cb473-3" tabindex="-1"></a></span>
<span id="cb473-4"><a href="article-figures.html#cb473-4" tabindex="-1"></a>plot_B <span class="ot">&lt;-</span> <span class="fu">plot_model_results</span>(</span>
<span id="cb473-5"><a href="article-figures.html#cb473-5" tabindex="-1"></a>  <span class="at">df_model_tidy =</span> data_B,</span>
<span id="cb473-6"><a href="article-figures.html#cb473-6" tabindex="-1"></a>  <span class="at">title =</span> results_nested<span class="sc">$</span>titles[[<span class="dv">2</span>]],</span>
<span id="cb473-7"><a href="article-figures.html#cb473-7" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb473-8"><a href="article-figures.html#cb473-8" tabindex="-1"></a>  <span class="at">vjust =</span> <span class="fl">0.05</span></span>
<span id="cb473-9"><a href="article-figures.html#cb473-9" tabindex="-1"></a>)</span>
<span id="cb473-10"><a href="article-figures.html#cb473-10" tabindex="-1"></a>plot_B <span class="ot">&lt;-</span> plot_B <span class="sc">+</span> painr<span class="sc">::</span><span class="fu">theme_individual</span>() </span>
<span id="cb473-11"><a href="article-figures.html#cb473-11" tabindex="-1"></a></span>
<span id="cb473-12"><a href="article-figures.html#cb473-12" tabindex="-1"></a><span class="do">## add figures</span></span>
<span id="cb473-13"><a href="article-figures.html#cb473-13" tabindex="-1"></a>plot_C <span class="ot">&lt;-</span> <span class="fu">plot_model_results</span>(</span>
<span id="cb473-14"><a href="article-figures.html#cb473-14" tabindex="-1"></a>  <span class="at">df_model_tidy =</span> results_nested<span class="sc">$</span>data[[<span class="dv">3</span>]],</span>
<span id="cb473-15"><a href="article-figures.html#cb473-15" tabindex="-1"></a>  <span class="at">title =</span> results_nested<span class="sc">$</span>titles[[<span class="dv">3</span>]],</span>
<span id="cb473-16"><a href="article-figures.html#cb473-16" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">1.6</span>,</span>
<span id="cb473-17"><a href="article-figures.html#cb473-17" tabindex="-1"></a>  <span class="at">vjust =</span> <span class="fl">0.06</span></span>
<span id="cb473-18"><a href="article-figures.html#cb473-18" tabindex="-1"></a>)</span>
<span id="cb473-19"><a href="article-figures.html#cb473-19" tabindex="-1"></a>plot_C <span class="ot">&lt;-</span> plot_C <span class="sc">+</span> painr<span class="sc">::</span><span class="fu">theme_individual</span>()</span></code></pre></div>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="article-figures.html#cb474-1" tabindex="-1"></a><span class="do">## panel</span></span>
<span id="cb474-2"><a href="article-figures.html#cb474-2" tabindex="-1"></a>panel_1_paper <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb474-3"><a href="article-figures.html#cb474-3" tabindex="-1"></a>  <span class="at">plotlist =</span> <span class="fu">list</span>(plot_A, plot_B),</span>
<span id="cb474-4"><a href="article-figures.html#cb474-4" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb474-5"><a href="article-figures.html#cb474-5" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb474-6"><a href="article-figures.html#cb474-6" tabindex="-1"></a>)</span>
<span id="cb474-7"><a href="article-figures.html#cb474-7" tabindex="-1"></a>panel_1_paper</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="article-figures.html#cb475-1" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb475-2"><a href="article-figures.html#cb475-2" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb475-3"><a href="article-figures.html#cb475-3" tabindex="-1"></a>    <span class="st">&quot;img&quot;</span>,</span>
<span id="cb475-4"><a href="article-figures.html#cb475-4" tabindex="-1"></a>    <span class="st">&quot;paper&quot;</span>,</span>
<span id="cb475-5"><a href="article-figures.html#cb475-5" tabindex="-1"></a>    <span class="st">&quot;panel_1.svg&quot;</span>),</span>
<span id="cb475-6"><a href="article-figures.html#cb475-6" tabindex="-1"></a>  panel_1_paper,</span>
<span id="cb475-7"><a href="article-figures.html#cb475-7" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">60</span>,</span>
<span id="cb475-8"><a href="article-figures.html#cb475-8" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">18</span>,</span>
<span id="cb475-9"><a href="article-figures.html#cb475-9" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb475-10"><a href="article-figures.html#cb475-10" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb475-11"><a href="article-figures.html#cb475-11" tabindex="-1"></a></span>
<span id="cb475-12"><a href="article-figures.html#cb475-12" tabindex="-1"></a></span>
<span id="cb475-13"><a href="article-figures.html#cb475-13" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb475-14"><a href="article-figures.html#cb475-14" tabindex="-1"></a>  <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb475-15"><a href="article-figures.html#cb475-15" tabindex="-1"></a>    <span class="st">&quot;img&quot;</span>,</span>
<span id="cb475-16"><a href="article-figures.html#cb475-16" tabindex="-1"></a>    <span class="st">&quot;paper&quot;</span>,</span>
<span id="cb475-17"><a href="article-figures.html#cb475-17" tabindex="-1"></a>    <span class="st">&quot;figure_2.svg&quot;</span>),</span>
<span id="cb475-18"><a href="article-figures.html#cb475-18" tabindex="-1"></a>  plot_C,</span>
<span id="cb475-19"><a href="article-figures.html#cb475-19" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">18</span>,</span>
<span id="cb475-20"><a href="article-figures.html#cb475-20" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">12</span>,</span>
<span id="cb475-21"><a href="article-figures.html#cb475-21" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb475-22"><a href="article-figures.html#cb475-22" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
</div>
<div id="adding-level-info-to-figure" class="section level2 hasAnchor" number="5.18">
<h2><span class="header-section-number">5.18</span> Adding level info to figure<a href="article-figures.html#adding-level-info-to-figure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="article-figures.html#cb476-1" tabindex="-1"></a><span class="co">#pak::pkg_install(&quot;ggpubr&quot;)</span></span>
<span id="cb476-2"><a href="article-figures.html#cb476-2" tabindex="-1"></a></span>
<span id="cb476-3"><a href="article-figures.html#cb476-3" tabindex="-1"></a>cat_info <span class="ot">&lt;-</span> labels_relevel <span class="sc">|&gt;</span></span>
<span id="cb476-4"><a href="article-figures.html#cb476-4" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb476-5"><a href="article-figures.html#cb476-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(new_name, level)</span>
<span id="cb476-6"><a href="article-figures.html#cb476-6" tabindex="-1"></a></span>
<span id="cb476-7"><a href="article-figures.html#cb476-7" tabindex="-1"></a>cat_info_no_dups <span class="ot">&lt;-</span> cat_info[<span class="sc">!</span><span class="fu">duplicated</span>(cat_info),] <span class="sc">|&gt;</span></span>
<span id="cb476-8"><a href="article-figures.html#cb476-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(new_name, level) <span class="sc">|&gt;</span></span>
<span id="cb476-9"><a href="article-figures.html#cb476-9" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Variable =</span> new_name,</span>
<span id="cb476-10"><a href="article-figures.html#cb476-10" tabindex="-1"></a>         <span class="at">Choice =</span> level) <span class="sc">|&gt;</span></span>
<span id="cb476-11"><a href="article-figures.html#cb476-11" tabindex="-1"></a>  <span class="fu">arrange</span>(Variable)</span>
<span id="cb476-12"><a href="article-figures.html#cb476-12" tabindex="-1"></a></span>
<span id="cb476-13"><a href="article-figures.html#cb476-13" tabindex="-1"></a>info_table <span class="ot">&lt;-</span> <span class="fu">ggtexttable</span>(cat_info_no_dups, <span class="at">rows =</span> <span class="cn">NULL</span>, </span>
<span id="cb476-14"><a href="article-figures.html#cb476-14" tabindex="-1"></a>                        <span class="at">theme =</span> <span class="fu">ttheme</span>())</span></code></pre></div>
</div>
<div id="ggpubr-panel" class="section level2 hasAnchor" number="5.19">
<h2><span class="header-section-number">5.19</span> GGpubr panel<a href="article-figures.html#ggpubr-panel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="article-figures.html#cb477-1" tabindex="-1"></a>panel_arrange <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(</span>
<span id="cb477-2"><a href="article-figures.html#cb477-2" tabindex="-1"></a>  plot_A,</span>
<span id="cb477-3"><a href="article-figures.html#cb477-3" tabindex="-1"></a>  plot_B,</span>
<span id="cb477-4"><a href="article-figures.html#cb477-4" tabindex="-1"></a>  plot_C,</span>
<span id="cb477-5"><a href="article-figures.html#cb477-5" tabindex="-1"></a>  info_table,</span>
<span id="cb477-6"><a href="article-figures.html#cb477-6" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb477-7"><a href="article-figures.html#cb477-7" tabindex="-1"></a>          <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb477-8"><a href="article-figures.html#cb477-8" tabindex="-1"></a>  <span class="fu">ggexport</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb477-9"><a href="article-figures.html#cb477-9" tabindex="-1"></a>    <span class="st">&quot;img&quot;</span>,</span>
<span id="cb477-10"><a href="article-figures.html#cb477-10" tabindex="-1"></a>    <span class="st">&quot;paper&quot;</span>,</span>
<span id="cb477-11"><a href="article-figures.html#cb477-11" tabindex="-1"></a>    <span class="st">&quot;panel_with_table.svg&quot;</span>),</span>
<span id="cb477-12"><a href="article-figures.html#cb477-12" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">17</span>,</span>
<span id="cb477-13"><a href="article-figures.html#cb477-13" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">6</span>,</span>
<span id="cb477-14"><a href="article-figures.html#cb477-14" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb477-15"><a href="article-figures.html#cb477-15" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
<pre><code>## [1] &quot;/Users/marcteunis/Documents/workspaces/painr-new/img/paper/panel_with_table%03d.svg&quot;</code></pre>
<pre><code>## file saved to /Users/marcteunis/Documents/workspaces/painr-new/img/paper/panel_with_table%03d.svg</code></pre>
</div>
<div id="area-under-the-receiver-operating-characteristic-curve-auc" class="section level2 hasAnchor" number="5.20">
<h2><span class="header-section-number">5.20</span> Area Under the receiver operating characteristic Curve (AUC)<a href="article-figures.html#area-under-the-receiver-operating-characteristic-curve-auc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The discriminative ability of the prognostic model will be determined based on the Area Under the receiver operating characteristic Curve (AUC), calibration will be assessed using a calibration plot”</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="article-figures.html#cb480-1" tabindex="-1"></a><span class="do">## Prediction of the probabilities based on our model</span></span>
<span id="cb480-2"><a href="article-figures.html#cb480-2" tabindex="-1"></a>predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(backward_model, <span class="at">newdata =</span> imputed_with_attitude_and_chronic, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb480-3"><a href="article-figures.html#cb480-3" tabindex="-1"></a></span>
<span id="cb480-4"><a href="article-figures.html#cb480-4" tabindex="-1"></a><span class="co"># Calculation and plotting the Area Under the receiver operating</span></span>
<span id="cb480-5"><a href="article-figures.html#cb480-5" tabindex="-1"></a><span class="co"># characteristic Curve (AUC).</span></span>
<span id="cb480-6"><a href="article-figures.html#cb480-6" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>is_painint_chronic, predicted_probs)</span></code></pre></div>
<pre><code>## Setting levels: control = FALSE, case = TRUE</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="article-figures.html#cb483-1" tabindex="-1"></a><span class="fu">auc</span>(roc_obj)</span></code></pre></div>
<pre><code>## Area under the curve: 0.8589</code></pre>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="article-figures.html#cb485-1" tabindex="-1"></a><span class="fu">plot</span>(roc_obj, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb485-2"><a href="article-figures.html#cb485-2" tabindex="-1"></a><span class="fu">lines</span>(roc_obj, <span class="at">ci =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb485-3"><a href="article-figures.html#cb485-3" tabindex="-1"></a></span>
<span id="cb485-4"><a href="article-figures.html#cb485-4" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">ci.auc</span>(roc_obj)</span>
<span id="cb485-5"><a href="article-figures.html#cb485-5" tabindex="-1"></a><span class="fu">print</span>(ci)</span></code></pre></div>
<pre><code>## 95% CI: 0.8195-0.8982 (DeLong)</code></pre>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="article-figures.html#cb487-1" tabindex="-1"></a><span class="co"># Add the AUC</span></span>
<span id="cb487-2"><a href="article-figures.html#cb487-2" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.7</span>, <span class="fl">0.2</span>, <span class="fu">paste</span>(<span class="st">&quot;AUC =&quot;</span>, <span class="fu">round</span>(<span class="fu">auc</span>(roc_obj), <span class="dv">2</span>)), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="article-figures.html#cb488-1" tabindex="-1"></a><span class="co"># Plotting the calibration curve</span></span>
<span id="cb488-2"><a href="article-figures.html#cb488-2" tabindex="-1"></a></span>
<span id="cb488-3"><a href="article-figures.html#cb488-3" tabindex="-1"></a><span class="co"># Measuring the predicted probability and the observed responses and creating</span></span>
<span id="cb488-4"><a href="article-figures.html#cb488-4" tabindex="-1"></a><span class="co"># a dataframe.</span></span>
<span id="cb488-5"><a href="article-figures.html#cb488-5" tabindex="-1"></a><span class="co"># Grouping predicted probabilities in deciles and calculation of the</span></span>
<span id="cb488-6"><a href="article-figures.html#cb488-6" tabindex="-1"></a><span class="co"># average predicted probabiloty and actual percentage per group and plot the</span></span>
<span id="cb488-7"><a href="article-figures.html#cb488-7" tabindex="-1"></a><span class="co"># calibration curve.</span></span>
<span id="cb488-8"><a href="article-figures.html#cb488-8" tabindex="-1"></a>  </span>
<span id="cb488-9"><a href="article-figures.html#cb488-9" tabindex="-1"></a>  predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(backward_model, <span class="at">newdata =</span> imputed_with_attitude_and_chronic, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb488-10"><a href="article-figures.html#cb488-10" tabindex="-1"></a>  observed_outcome <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>is_painint_chronic)</span>
<span id="cb488-11"><a href="article-figures.html#cb488-11" tabindex="-1"></a>  </span>
<span id="cb488-12"><a href="article-figures.html#cb488-12" tabindex="-1"></a>  calibration_data <span class="ot">&lt;-</span></span>
<span id="cb488-13"><a href="article-figures.html#cb488-13" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">Predicted =</span> predicted_probs, <span class="at">Observed =</span> observed_outcome)</span>
<span id="cb488-14"><a href="article-figures.html#cb488-14" tabindex="-1"></a>  </span>
<span id="cb488-15"><a href="article-figures.html#cb488-15" tabindex="-1"></a>  calibration_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Predicted =</span> predicted_probs, <span class="at">Observed =</span> observed_outcome)</span>
<span id="cb488-16"><a href="article-figures.html#cb488-16" tabindex="-1"></a>  calibration_data<span class="sc">$</span>PredictedGroup <span class="ot">&lt;-</span> <span class="fu">cut</span>(calibration_data<span class="sc">$</span>Predicted, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.25</span>), <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb488-17"><a href="article-figures.html#cb488-17" tabindex="-1"></a>  </span>
<span id="cb488-18"><a href="article-figures.html#cb488-18" tabindex="-1"></a>  grouped_data <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(<span class="fu">cbind</span>(Observed, Predicted) <span class="sc">~</span> PredictedGroup, <span class="at">data =</span> calibration_data, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(x)))</span>
<span id="cb488-19"><a href="article-figures.html#cb488-19" tabindex="-1"></a>  <span class="fu">names</span>(grouped_data)[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Mean_Predicted&quot;</span>, <span class="st">&quot;Mean_Observed&quot;</span>)</span>
<span id="cb488-20"><a href="article-figures.html#cb488-20" tabindex="-1"></a>  </span>
<span id="cb488-21"><a href="article-figures.html#cb488-21" tabindex="-1"></a>  <span class="do">## </span><span class="al">TODO</span><span class="do">: cleanup calibrarion plot, vierkant maken, schaal x en y as gelijk maken</span></span>
<span id="cb488-22"><a href="article-figures.html#cb488-22" tabindex="-1"></a>  </span>
<span id="cb488-23"><a href="article-figures.html#cb488-23" tabindex="-1"></a>  calibration_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(grouped_data, <span class="fu">aes</span>(<span class="at">x =</span> Mean_Predicted, <span class="at">y =</span> Mean_Observed)) <span class="sc">+</span></span>
<span id="cb488-24"><a href="article-figures.html#cb488-24" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb488-25"><a href="article-figures.html#cb488-25" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="fu">lowess</span>(grouped_data<span class="sc">$</span>Mean_Predicted, grouped_data<span class="sc">$</span>Mean_Observed)), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb488-26"><a href="article-figures.html#cb488-26" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb488-27"><a href="article-figures.html#cb488-27" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean Predicted Probability&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Mean Observed Probability&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Calibration Plot&quot;</span>) <span class="sc">+</span></span>
<span id="cb488-28"><a href="article-figures.html#cb488-28" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb488-29"><a href="article-figures.html#cb488-29" tabindex="-1"></a>  </span>
<span id="cb488-30"><a href="article-figures.html#cb488-30" tabindex="-1"></a>  <span class="fu">print</span>(calibration_plot)</span></code></pre></div>
<p><img src="05_paper_figures_files/figure-html/unnamed-chunk-21-2.png" width="672" /></p>
</div>
<div id="calibration-curve-1" class="section level2 hasAnchor" number="5.21">
<h2><span class="header-section-number">5.21</span> Calibration curve<a href="article-figures.html#calibration-curve-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Results:
The calibration plot (figure X) revealed acceptable alignment for patients not developing chronic pain. However, for patients developing chronic pain, the model tended to overestimate the risk. Despite this, the calibration remained within acceptable limits.</p>
</div>
<div id="formally-testing-the-goodness-of-fit-using-the-hosmer-and-lemeshow." class="section level2 hasAnchor" number="5.22">
<h2><span class="header-section-number">5.22</span> Formally testing the goodness-of-fit using the Hosmer and Lemeshow.<a href="article-figures.html#formally-testing-the-goodness-of-fit-using-the-hosmer-and-lemeshow." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="article-figures.html#cb489-1" tabindex="-1"></a>predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(backward_model, <span class="at">newdata =</span> imputed_with_attitude_and_chronic, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb489-2"><a href="article-figures.html#cb489-2" tabindex="-1"></a></span>
<span id="cb489-3"><a href="article-figures.html#cb489-3" tabindex="-1"></a>gof <span class="ot">&lt;-</span> <span class="fu">hoslem.test</span>(imputed_with_attitude_and_chronic<span class="sc">$</span>is_painint_chronic, predicted_probs, <span class="at">g =</span> <span class="dv">10</span>)</span>
<span id="cb489-4"><a href="article-figures.html#cb489-4" tabindex="-1"></a></span>
<span id="cb489-5"><a href="article-figures.html#cb489-5" tabindex="-1"></a>gof <span class="sc">|&gt;</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   statistic p.value parameter method                                        
##       &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                                         
## 1      8.07   0.427         8 Hosmer and Lemeshow goodness of fit (GOF) test</code></pre>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="article-figures.html#cb491-1" tabindex="-1"></a>x_sqrd <span class="ot">&lt;-</span> gof<span class="sc">$</span>statistic[<span class="dv">1</span>] </span>
<span id="cb491-2"><a href="article-figures.html#cb491-2" tabindex="-1"></a>p_value_gof <span class="ot">&lt;-</span> gof<span class="sc">$</span>p.value[<span class="dv">1</span>]</span></code></pre></div>
<p>Results:
X-squared = 8.0693394, DF = 8, p-value = 0.4267263
We found a high p-value suggests there’s no statistically significant difference between observed and expected frequencies, indicating
that the model fits the data well.</p>
<p>The model fit will be quantified as Nagelkerke’s R2</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="article-figures.html#cb492-1" tabindex="-1"></a>nagelkerkeR2 <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb492-2"><a href="article-figures.html#cb492-2" tabindex="-1"></a>  LL_0 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(<span class="fu">update</span>(model, .<span class="sc">~</span><span class="dv">1</span>)))</span>
<span id="cb492-3"><a href="article-figures.html#cb492-3" tabindex="-1"></a>  LL_f <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(model))</span>
<span id="cb492-4"><a href="article-figures.html#cb492-4" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>((<span class="dv">2</span><span class="sc">/</span><span class="fu">nrow</span>(model<span class="sc">$</span>data))<span class="sc">*</span>(LL_0 <span class="sc">-</span> LL_f))) <span class="sc">/</span></span>
<span id="cb492-5"><a href="article-figures.html#cb492-5" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>LL_0<span class="sc">/</span><span class="fu">nrow</span>(model<span class="sc">$</span>data)))</span>
<span id="cb492-6"><a href="article-figures.html#cb492-6" tabindex="-1"></a>  <span class="fu">return</span>(R2)</span>
<span id="cb492-7"><a href="article-figures.html#cb492-7" tabindex="-1"></a>}</span>
<span id="cb492-8"><a href="article-figures.html#cb492-8" tabindex="-1"></a></span>
<span id="cb492-9"><a href="article-figures.html#cb492-9" tabindex="-1"></a><span class="fu">nagelkerkeR2</span>(backward_model)</span></code></pre></div>
<pre><code>## [1] 0.3076664</code></pre>
<p>Result: R2 0.3076664
Internal validation will be performed using bootstrap resampling to estimate the optimism-corrected AUC and to yield a measure of overfitting (i.e., the shrinkage factor). The shrinkage factor (a constant between 0 and 1) will be used to multiply the regression coefficient by. Generally, regression coefficients (and resulting predictions) are too extreme in case of overfitting, which is counteracted by the shrinking of regression coefficients.</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="article-figures.html#cb494-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb494-2"><a href="article-figures.html#cb494-2" tabindex="-1"></a></span>
<span id="cb494-3"><a href="article-figures.html#cb494-3" tabindex="-1"></a><span class="fu">formula</span>(backward_model)</span></code></pre></div>
<pre><code>## is_painint_chronic ~ sex + pain_intensity + pidbr + headache + 
##     posture_work + duration_beliefs + concerns + treatment_beliefs + 
##     distress + identity_beliefs + self_efficacy</code></pre>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="article-figures.html#cb496-1" tabindex="-1"></a><span class="co"># Respecifying the model with the LRM function and internal validate our model.</span></span>
<span id="cb496-2"><a href="article-figures.html#cb496-2" tabindex="-1"></a>new_model <span class="ot">&lt;-</span> <span class="fu">lrm</span>(<span class="fu">formula</span>(backward_model), <span class="at">data=</span>imputed_with_attitude_and_chronic, <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>)</span>
<span id="cb496-3"><a href="article-figures.html#cb496-3" tabindex="-1"></a></span>
<span id="cb496-4"><a href="article-figures.html#cb496-4" tabindex="-1"></a>validation_result <span class="ot">&lt;-</span> <span class="fu">validate</span>(new_model, <span class="at">method=</span><span class="st">&quot;boot&quot;</span>, <span class="at">B=</span><span class="dv">1000</span>)</span>
<span id="cb496-5"><a href="article-figures.html#cb496-5" tabindex="-1"></a></span>
<span id="cb496-6"><a href="article-figures.html#cb496-6" tabindex="-1"></a><span class="fu">print</span>(validation_result)</span></code></pre></div>
<pre><code>##           index.orig training    test optimism index.corrected    n
## Dxy           0.7177   0.7424  0.6776   0.0648          0.6529 1000
## R2            0.3077   0.3431  0.2745   0.0686          0.2391 1000
## Intercept     0.0000   0.0000 -0.2660   0.2660         -0.2660 1000
## Slope         1.0000   1.0000  0.8274   0.1726          0.8274 1000
## Emax          0.0000   0.0000  0.0946   0.0946          0.0946 1000
## D             0.1597   0.1804  0.1411   0.0393          0.1204 1000
## U            -0.0033  -0.0033  0.0049  -0.0082          0.0049 1000
## Q             0.1630   0.1837  0.1362   0.0475          0.1155 1000
## B             0.0770   0.0734  0.0802  -0.0069          0.0838 1000
## g             1.9372   2.1388  1.7481   0.3907          1.5465 1000
## gp            0.1264   0.1324  0.1200   0.0124          0.1140 1000</code></pre>
<p>Calculating of the corrected AUC.
Extracting the original and optimism values from the validation result
Calculating of the corrected Dxy
Converting Dxy to AUC
Calculating the corrected AUC</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="article-figures.html#cb498-1" tabindex="-1"></a>original_dxy <span class="ot">&lt;-</span> validation_result[<span class="st">&quot;Dxy&quot;</span>, <span class="st">&quot;index.orig&quot;</span>]</span>
<span id="cb498-2"><a href="article-figures.html#cb498-2" tabindex="-1"></a>optimism_dxy <span class="ot">&lt;-</span> validation_result[<span class="st">&quot;Dxy&quot;</span>, <span class="st">&quot;optimism&quot;</span>]</span>
<span id="cb498-3"><a href="article-figures.html#cb498-3" tabindex="-1"></a></span>
<span id="cb498-4"><a href="article-figures.html#cb498-4" tabindex="-1"></a>corrected_dxy <span class="ot">&lt;-</span> original_dxy <span class="sc">-</span> optimism_dxy</span>
<span id="cb498-5"><a href="article-figures.html#cb498-5" tabindex="-1"></a><span class="fu">print</span>(corrected_dxy)</span></code></pre></div>
<pre><code>## [1] 0.6529234</code></pre>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="article-figures.html#cb500-1" tabindex="-1"></a>original_auc <span class="ot">&lt;-</span> original_dxy <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span></span>
<span id="cb500-2"><a href="article-figures.html#cb500-2" tabindex="-1"></a>optimism_auc <span class="ot">&lt;-</span> optimism_dxy <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb500-3"><a href="article-figures.html#cb500-3" tabindex="-1"></a></span>
<span id="cb500-4"><a href="article-figures.html#cb500-4" tabindex="-1"></a>corrected_auc <span class="ot">&lt;-</span> original_auc <span class="sc">-</span> optimism_auc</span>
<span id="cb500-5"><a href="article-figures.html#cb500-5" tabindex="-1"></a><span class="fu">print</span>(corrected_auc)</span></code></pre></div>
<pre><code>## [1] 0.8264617</code></pre>
<p>Result: the corrected AUC = 0.8264617 The difference from the original AUC was 0.86 on the entire dataset. The corrected is not much lower and the overfitting is therefore relatively low. The model appears to have a robust discriminatory ability.</p>
<p>Show the corrected AUC in the figure made earlier.
roc_obj &lt;- roc(observed_outcome, predicted_probs)
plot(roc_obj, main=“ROC Curve”, col=“blue”, lwd=2)
Voeg de originele AUC toe als tekst
text(0.3, 0.3, labels=sprintf(“Original AUC: %0.2f”, auc(roc_obj)), adj=c(0,1))
Voeg de gecorrigeerde AUC toe als tekst
text(0.3, 0.2, labels=sprintf(“Corrected AUC: %0.2f”, 0.8296583), adj=c(0,1), col=“red”)</p>
<p>Multiplying all the coefficients of our model by the shrinkage factor ‘sf’,
and estimate the intercept, so that the average estimated probability is equal
to the frequency of the outcome.</p>
<p>predictiemodel &lt;- round(new_model<span class="math inline">\(coef*0.8274, 3) predictiemodel.lp &lt;- cbind(new_model\)</span>x) %*% predictiemodel[-1]</p>
<p>predictiemodel[“Intercept”] &lt;- round(lrm.fit(y=imputed_with_attitude_and_chronic<span class="math inline">\(is_painint_chronic, offset=predictiemodel.lp)\)</span>coef, 3)</p>
<p>print (predictiemodel)</p>
<p>Checking whether the internally validated model gives the same average
estimated probability as the average outcome (calibration in the large)</p>
<p>predictiemodel.linearpredictor &lt;- predictiemodel[1] + new_model$x %*% predictiemodel[-1]</p>
<p>Calculating the linear predictor for everyone in the database.
Creating a function to calculate the risk: 1/(1+exp(-(LP)))
Calculating the probability for everyone in the database and average probability.</p>
<p>risk &lt;- function(lp)</p>
<p>{risk &lt;- 1/(1 + exp(-lp))}</p>
<p>risk.predicted &lt;- risk(predictiemodel.linearpredictor)</p>
<p>mean(risk.predicted)</p>
<p>mean(imputed_with_attitude_and_chronic$is_painint_chronic)</p>
<p>Result = 0.1028 and 0.1028.
The model is well calibrated in the large.</p>
</div>
<div id="intermezzo---linear-predictors" class="section level2 hasAnchor" number="5.23">
<h2><span class="header-section-number">5.23</span> Intermezzo - Linear Predictors<a href="article-figures.html#intermezzo---linear-predictors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The patient is a female who reports a pain intensity of 9 on the Numeric Pain Rating Scale (NPRS). She does experience pain in other body regions. Since the onset of neck pain, she has also developed headaches, which were not present before the neck pain. She is currently not working. Her anticipated duration of symptoms is rated as 8 on a 0-10 scale, and she expresses significant concern about her condition, also scoring an 8 on a 0-10 scale. Her confidence in the therapy is high, rated at 9 on a 0-10 scale. She experiences a relatively high level of stress, scoring 18 on a 0-21 scale. She feels that she understands her pain well, rating this understanding as 9 on a 0-10 scale, and a high score in self-efficacy, with a score of 12 on a 0-12 scale.</p>
<p>Linear predictor (LP) = -5.782 + (0.468<em>sex[female = 1]) + (0.227</em>pain intensity) + (0.734<em>pain in different body regions) + (0.726</em>headache(s) since the neck pain) + (-0.070<em>headache(s) before the neck pain) + (0.384</em>potential to self-modify posture work) + (1.311<em>work status) + (0.184</em>duration beliefs) + (0.108<em>concerns) + (-0.204</em>treatment beliefs) + (0.083<em>distress) + (-0.142</em>identity beliefs) + (0.109*self-efficacy).</p>
<p>Probability of chronicity = 1/(1 + exp(-LP))</p>
<p>Patient X
Linear predictor (LP) = -5.782 + (0.468<em>1) + (0.227</em>7) + (0.734<em>1) + (0.726</em>1) + (-0.070<em>0) + (0.384</em>0) + (1.311<em>1) + (0.184</em>8) + (0.108<em>8) + (-0.204</em>9) + (0.083<em>18) + (-0.142</em>9) + (0.109*12) = 1.07</p>
<p>Probability of chronicity = 1/(1 + exp(1.07)) = 74.5%</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="development-and-internal-validation-of-a-multivariable-prognostic-model-for-chronification-of-non-specific-neck-pain-in-physiotherapy.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
